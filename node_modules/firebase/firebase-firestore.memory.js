!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(cf){"use strict";try{(function(){cf=cf&&Object.prototype.hasOwnProperty.call(cf,"default")?cf.default:cf;var t,a,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((u=u.apply(t,s||[])).next())})}function y(n,r){var i,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}(e=a=a||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";a.DEBUG,a.VERBOSE,a.INFO,a.WARN,a.ERROR,a.SILENT;function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u=a.INFO,h=((t={})[a.DEBUG]="log",t[a.VERBOSE]="log",t[a.INFO]="info",t[a.WARN]="warn",t[a.ERROR]="error",t),c=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.DEBUG],t)),this._logHandler.apply(this,s([this,a.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.VERBOSE],t)),this._logHandler.apply(this,s([this,a.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.INFO],t)),this._logHandler.apply(this,s([this,a.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.WARN],t)),this._logHandler.apply(this,s([this,a.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.ERROR],t)),this._logHandler.apply(this,s([this,a.ERROR],t))},f);function f(t){this.name=t,this._logLevel=u,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var l,v=(n(g,l=Error),g);function g(t,e){var n=l.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(r=i,s.replace(b,function(t,e){var n=r[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new v(o,u),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var b=/\{\$([^}]+)}/g,E=(I.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},I.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},I.prototype.setServiceProps=function(t){return this.serviceProps=t,this},I);function I(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_=_||{},R=N||self;function S(){}function D(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function k(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),V=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function P(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:P).apply(null,arguments)}function U(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now||function(){return+new Date};function x(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.da=function(){if(!this.j&&(this.j=!0,this.C(),0))t=this,Object.prototype.hasOwnProperty.call(t,O)&&t[O]||(t[O]=++V);var t},F.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var W,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var Y=R.navigator;if(Y){var Z=Y.userAgent;if(Z){W=Z;break t}}W=""}function K(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function nt(t){return nt[" "](t),t}nt[" "]=S;var rt,it,ot=X(W,"Opera"),st=X(W,"Trident")||X(W,"MSIE"),at=X(W,"Edge"),ut=at||st,ht=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),ct=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function ft(){var t=R.document;return t?t.documentMode:void 0}t:{var lt="",pt=(it=W,ht?/rv:([^\);]+)(\)|;)/.exec(it):at?/Edge\/([\d\.]+)/.exec(it):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(it):ct?/WebKit\/(\S+)/.exec(it):ot?/(?:Version)[ \/]?(\S+)/.exec(it):void 0);if(pt&&(lt=pt?pt[1]:""),st){var dt=ft();if(null!=dt&&dt>parseFloat(lt)){rt=String(dt);break t}}rt=lt}var yt,vt={};function gt(a){return t=a,e=function(){for(var t=0,e=Q(String(rt)).split("."),n=Q(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}if(R.document&&st){var mt=ft();yt=mt||(parseInt(rt,10)||void 0)}else yt=void 0;var wt=yt,bt=!st||9<=Number(wt),Et=st&&!gt("9"),It=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",S,e),R.removeEventListener("test",S,e)}catch(t){}return t}();function At(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(At.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}At.prototype.b=function(){this.defaultPrevented=!0},x(Tt,At);var Nt={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),Rt=0;function St(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++Rt,this.V=this.X=!1}function Dt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function kt(t){this.src=t,this.a={},this.b=0}function Lt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=j(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Dt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}kt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new St(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Vt="closure_lm_"+(1e6*Math.random()|0),Mt={};function Pt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Bt(r);return e&&e[_t]?e.sa(n,r,L(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Pt(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[_t]?t.ra(e,n,L(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!bt)return null;var a,u,h=jt(t);if(h||(t[Vt]=h=new kt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(a=Ft,r=u=bt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)It||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(qt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ut(t){if("number"!=typeof t&&t&&!t.V){var e=t.src;if(e&&e[_t])Lt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(qt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jt(e))?(Lt(n,t),0==n.b&&(n.src=null,e[Vt]=null)):Dt(t)}}}function qt(t){return t in Mt?Mt[t]:Mt[t]="on"+t}function xt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Ut(t),n.call(r,e)}function Ft(t,e){if(t.V)return!0;if(bt)return xt(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=R,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return xt(t,e=new Tt(e,this))}function jt(t){return(t=t[Vt])instanceof kt?t:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==D(e)?e:(e[Gt]||(e[Gt]=function(t){return e.handleEvent(t)}),e[Gt])}function zt(){F.call(this),this.c=new kt(this),(this.J=this).A=null}function Ht(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.V&&s.capture==n){var a=s.listener,u=s.aa||s.src;s.X&&Lt(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}x(zt,F),zt.prototype[_t]=!0,(T=zt.prototype).addEventListener=function(t,e,n,r){Pt(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=Bt(r),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(Dt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&Ut(r))}(this,t,e,n,r)},T.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new At(t,n);else if(t instanceof At)t.target=t.target||n;else{var i=t;et(t=new At(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Ht(s,r,!0,t)&&i}if(i=Ht(s=t.a=n,r,!0,t)&&i,i=Ht(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Ht(s=t.a=e[o],r,!1,t)&&i;return i},T.C=function(){if(zt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Dt(n[r]);delete e.a[t],e.b--}}this.A=null},T.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Wt=R.JSON.stringify;function Qt(){this.b=this.a=null}var Xt,Jt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new Zt},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Zt(){this.next=this.b=this.a=null}function Kt(t){R.setTimeout(function(){throw t},0)}function $t(t,e){var n;Xt||(n=R.Promise.resolve(void 0),Xt=function(){n.then(ne)}),te||(Xt(),te=!0),ee.add(t,e)}Qt.prototype.add=function(t,e){var n=Jt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var te=!(Zt.prototype.reset=function(){this.next=this.b=this.a=null}),ee=new Qt;function ne(){for(var t;r=n=void 0,r=null,(n=ee).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),t=r;){try{t.a.call(t.b)}catch(t){Kt(t)}var e=Jt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}var n,r;te=!1}function re(t,e){zt.call(this),this.b=t||1,this.a=e||R,this.f=C(this.Ua,this),this.g=q()}function ie(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function oe(t,e,n){if("function"==D(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}function se(t,e,n){F.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function ae(t){t.T=oe(t.b,t.c),t.f.apply(null,t.a)}function ue(t){F.call(this),this.b=t,this.a={}}x(re,zt),(T=re.prototype).Z=!1,T.L=null,T.Ua=function(){if(this.Z){var t=q()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ie(this),this.start()))}},T.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=q())},T.C=function(){re.M.C.call(this),ie(this),delete this.a},x(se,F),(T=se.prototype).ba=!1,T.T=null,T.Ia=function(t){this.a=arguments,this.T?this.ba=!0:ae(this)},T.C=function(){se.M.C.call(this),this.T&&(R.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},T.Pa=function(){this.T=null,this.ba&&(this.ba=!1,ae(this))},x(ue,F);var he=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(he[0]=n.toString()),n=he);for(var i=0;i<n.length;i++){var o=Pt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){K(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function le(){}ue.prototype.C=function(){ue.M.C.call(this),fe(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pe=null;function de(){return pe=pe||new zt}function ye(t){At.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){At.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){At.call(this,"timingevent",t)}function be(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}x(ye,At),x(ge,At),x(we,At);var Ee={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Ie={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Ae(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Ae.prototype.a=null;var _e,Re={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Se(){At.call(this,"d")}function De(){At.call(this,"c")}function ke(){}function Le(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ue(this),this.N=Oe,t=ut?125:void 0,this.O=new re(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}x(Se,At),x(De,At),x(ke,Ae),_e=new ke;var Oe=45e3,Ve={},Me={};function Pe(t,e,n){t.B=1,t.f=rn(Ze(e)),t.j=n,t.F=!0,Ce(t,null)}function Ce(t,e){t.s=q(),xe(t),t.A=Ze(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),gn(n.b,"t",r),t.w=0,t.a=ur(t.g,t.g.w?e:null),0<t.J&&(t.D=new se(C(t.ya,t,t.a),t.J)),ce(t.G,t.a,"readystatechange",t.Sa),e=t.m?$(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ve(1)}function Ue(t,e,n){for(var r=!0;!t.l&&t.w<n.length;){var i=qe(t,n);if(i==Me){4==e&&(t.c=4,me(14),r=!1);break}if(i==Ve){t.c=4,me(15),r=!1;break}ze(t,i)}4==e&&0==n.length&&(t.c=1,me(16),r=!1),t.b=t.b&&r,r||(Be(t),Ge(t))}function qe(t,e){var n=t.w,r=e.indexOf("\n",n);return-1==r?Me:(n=Number(e.substring(n,r)),isNaN(n)?Ve:(r+=1)+n>e.length?Me:(e=e.substr(r,n),t.w=r+n,e))}function xe(t){t.P=q()+t.N,Fe(t,t.N)}function Fe(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=be(C(t.Qa,t),e)}function je(t){t.h&&(R.clearTimeout(t.h),t.h=null)}function Ge(t){0==t.g.u||t.l||rr(t.g,t)}function Be(t){je(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ie(t.O),fe(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function ze(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||Tn(n.b,t)))if(n.A=t.H,!t.o&&Tn(n.b,t)&&3==n.u){try{var r=n.ja.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;nr(n),n.a.cancel(),n.a=null}er(n),me(18)}}else n.ia=i[1],0<n.ia-n.G&&i[2]<37500&&n.U&&0==n.m&&!n.l&&(n.l=be(C(n.Na,n),6e3));if(An(n.b)<=1&&n.O){try{n.O()}catch(t){}n.O=void 0}}else or(n,11)}else if(!t.o&&n.a!=t||nr(n),!H(e))for(e=r=n.ja.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.G=i[0],i=i[1],2==n.u)if("c"==i[0]){n.B=i[1],n.R=i[2];var o=i[3];null!=o&&(n.oa=o);var s=i[5];null!=s&&"number"==typeof s&&0<s&&(n.D=1.5*s);var a=n,u=t.a;if(u){var h=u.a?u.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var c=a.b;!c.a&&(X(h,"spdy")||X(h,"quic")||X(h,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(Nn(c,c.b),c.b=null))}if(a.s){var f=u.a?u.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(a.ha=f,nn(a.v,a.s,f))}}n.u=3,n.c&&n.c.na();var l=t;if((a=n).ea=ar(a,a.w?a.R:null,a.P),l.o){_n(a.b,l);var p=l,d=a.D;d&&p.setTimeout(d),p.h&&(je(p),xe(p)),a.a=l}else tr(a);0<n.f.length&&Yn(n)}else"stop"!=i[0]&&"close"!=i[0]||or(n,7);else 3==n.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?or(n,7):Qn(n):"noop"!=i[0]&&n.c&&n.c.ma(i),n.m=0);ve(4)}catch(t){}}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)G(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof We)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Xe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=Le.prototype).setTimeout=function(t){this.N=t},T.Sa=function(t){t=t.target;var e=this.D;e&&3==Bn(t)?e.Ia():this.ya(t)},T.ya=function(t){try{if(t==this.a)t:{var e=Bn(this.a),n=this.a.qa(),r=this.a.S();if(!(e<3||3==e&&!ut&&!this.a.Y())){this.l||4!=e||7==n||ve(8==n||r<=0?3:2),je(this);var i=this.a.S();this.H=i;var o=this.a.Y();if(this.b=200==i){if(this.R&&!this.o){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.c=3,me(12),Be(this),Ge(this);break t}this.o=!0,ze(this,u)}this.F?(Ue(this,e,o),ut&&this.b&&3==e&&(ce(this.G,this.O,"tick",this.Ra),this.O.start())):ze(this,o),4==e&&Be(this),this.b&&!this.l&&(4==e?rr(this.g,this):(this.b=!1,xe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,me(12)):(this.c=0,me(13)),Be(this),Ge(this)}}}catch(t){}},T.Ra=function(){if(this.a){var t=Bn(this.a),e=this.a.Y();this.w<e.length&&(je(this),Ue(this,t,e),this.b&&4!=t&&xe(this))}},T.cancel=function(){this.l=!0,Be(this)},T.Qa=function(){this.h=null;var t=q();0<=t-this.P?(2!=this.B&&(ve(3),me(17)),Be(this),this.c=2,Ge(this)):Fe(this,this.P-t)},(T=We.prototype).I=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.K=function(){return Qe(this),this.a.concat()},T.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},T.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye){this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,$e(this,t.c),tn(this,t.h),this.g=t.g,e=t.b;var n=new pn;n.c=e.c,e.a&&(n.a=new We(e.a),n.b=e.b),en(this,n),this.i=t.i}else t&&(n=String(t).match(Je))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=on(n[2]||""),$e(this,n[3]||"",!0),tn(this,n[4]),this.g=on(n[5]||"",!0),en(this,n[6]||"",!0),this.i=on(n[7]||"")):(this.a=!!e,this.b=new pn(null,this.a))}function Ze(t){return new Ye(t)}function Ke(t,e,n){t.f=n?on(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?on(e,!0):e}function tn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function en(t,e,n){var r,i;e instanceof pn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(dn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(yn(this,e),gn(this,n,t))},r)),r.f=i):(n||(e=sn(e,fn)),t.b=new pn(e,t.a))}function nn(t,e,n){t.b.set(e,n)}function rn(t){return nn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function on(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function sn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,an),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function an(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(sn(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(sn(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(sn(n,"/"==n.charAt(0)?cn:hn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",sn(n,ln)),t.join("")};var un=/[#\/\?@]/g,hn=/[#\?:]/g,cn=/[#\?]/g,fn=/[#\?@]/g,ln=/#/g;function pn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function dn(n){n.a||(n.a=new We,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function yn(t,e){dn(t),e=mn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function vn(t,e){return dn(t),e=mn(t,e),Xe(t.a.b,e)}function gn(t,e,n){yn(t,e),0<n.length&&(t.c=null,t.a.set(mn(t,e),z(n)),t.b+=n.length)}function mn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function wn(t,e){this.b=t,this.a=e}function bn(t){this.g=t||En,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ca&&R.ca.ua&&R.ca.ua()&&R.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(T=pn.prototype).add=function(t,e){dn(this),this.c=null,t=mn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(n,r){dn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},T.K=function(){dn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.I=function(t){dn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=B(e,this.a.get(mn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},T.set=function(t,e){return dn(this),this.c=null,vn(this,t=mn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.I(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var En=10;function In(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Nn(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Rn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Sn(){}function Dn(){this.a=new Sn}function kn(t,r,e){var i=e||"";try{He(t,function(t,e){var n=t;L(t)&&(n=Wt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Ln(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}bn.prototype.cancel=function(){var e,t;if(this.c=Rn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Sn.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},Sn.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var On=R.JSON.parse;function Vn(t){zt.call(this),this.headers=new We,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Mn,this.B=this.F=!1}x(Vn,zt);var Mn="",Pn=/^https?$/i,Cn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function qn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,xn(t),jn(t)}function xn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Fn(t){if(t.b&&void 0!==_&&(!t.s[1]||4!=Bn(t)||2!=t.S()))if(t.l&&4==Bn(t))oe(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Bn(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.D).match(Je)[1]||null;if(!o&&R.self&&R.self.location){var s=R.self.location.protocol;o=s.substr(0,s.length-1)}i=!Pn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<Bn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.S()+"]",xn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){Gn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Gn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function Bn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",K(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):nn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Hn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Hn("baseRetryDelayMs",5e3,t),this.Ga=Hn("retryDelaySeedMs",1e4,t),this.Da=Hn("forwardChannelMaxRetries",2,t),this.ga=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new bn(t&&t.concurrentRequestLimit),this.ja=new Dn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Qn(t){if(Xn(t),3==t.u){var e=t.H++,n=Ze(t.v);nn(n,"SID",t.B),nn(n,"RID",e),nn(n,"TYPE","terminate"),Kn(t,n),(e=new Le(t,e,void 0)).B=2,e.f=rn(Ze(n)),n=!1,R.navigator&&R.navigator.sendBeacon&&(n=R.navigator.sendBeacon(e.f.toString(),"")),!n&&R.Image&&((new Image).src=e.f,n=!0),n||(e.a=ur(e.g,null),e.a.$(e.f)),e.s=q(),xe(e)}sr(t)}function Xn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(R.clearTimeout(t.i),t.i=null),nr(t),t.b.cancel(),t.g&&("number"==typeof t.g&&R.clearTimeout(t.g),t.g=null)}function Jn(t,e){t.f.push(new wn(t.Fa++,e)),3==t.u&&Yn(t)}function Yn(t){In(t.b)||t.g||(t.g=!0,$t(t.xa,t),t.o=0)}function Zn(t,e){var n;n=e?e.W:t.H++;var r=Ze(t.v);nn(r,"SID",t.B),nn(r,"RID",n),nn(r,"AID",t.G),Kn(t,r),t.h&&t.j&&zn(r,t.h,t.j),n=new Le(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),Nn(t.b,n),Pe(n,r,e)}function Kn(t,n){t.c&&He({},function(t,e){nn(n,e,t)})}function $n(t,e,n){n=Math.min(t.f.length,n);var r=t.c?C(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=i[u].b,c=i[u].a;if((h-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{kn(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(a){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function tr(t){t.a||t.i||(t.J=1,$t(t.wa,t),t.m=0)}function er(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=be(C(t.wa,t),ir(t,t.m)),t.m++,1)}function nr(t){null!=t.l&&(R.clearTimeout(t.l),t.l=null)}function rr(t,e){var n=null;if(t.a==e){nr(t),t.a=null;var r=2}else{if(!Tn(t.b,e))return;n=e.i,_n(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==r){n=e.j?e.j.length:0,e=q()-e.s;var i=t.o;(r=de()).dispatchEvent(new we(r)),Yn(t)}else tr(t);else if(3==(i=e.c)||0==i&&0<t.A||!(1==r&&function(t,e){if(!(An(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=be(C(t.xa,t,e),ir(t,t.o)),t.o++,1}}(t,e)||2==r&&er(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function or(t,e){if(2==e){var n=null;t.c&&(n=null);var r=C(t.Ta,t);n||(n=new Ye("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||Ke(n,"https"),rn(n)),function(t,e){var n=new le;if(R.Image){var r=new Image;r.onload=U(Ln,n,r,"TestLoadImage: loaded",!0,e),r.onerror=U(Ln,n,r,"TestLoadImage: error",!1,e),r.onabort=U(Ln,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=U(Ln,n,r,"TestLoadImage: timeout",!1,e),R.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else me(2);t.u=0,t.c&&t.c.la(e),sr(t),Xn(t)}function sr(t){t.u=0,t.A=-1,t.c&&(0==Rn(t.b).length&&0==t.f.length||(t.b.c.length=0,z(t.f),t.f.length=0),t.c.ka())}function ar(t,e,n){var r,i,o,s,a,u,h=(r=n)instanceof Ye?Ze(r):new Ye(r,void 0);if(""!=h.c)e&&$e(h,e+"."+h.c),tn(h,h.h);else{var c=R.location;i=c.protocol,o=e?e+"."+c.hostname:c.hostname,s=+c.port,a=n,u=new Ye(null,void 0),i&&Ke(u,i),o&&$e(u,o),s&&tn(u,s),a&&(u.g=a),h=u}return t.N&&K(t.N,function(t,e){nn(h,e,t)}),e=t.s,n=t.ha,e&&n&&nn(h,e,n),nn(h,"VER",t.oa),Kn(t,h),h}function ur(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Vn(t.Ea)).F=t.w,e}function hr(){}function cr(){if(st&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function fr(t,e){zt.call(this),this.a=new Wn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function lr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){De.call(this),this.status=1}function dr(t){this.a=t}(T=Vn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Te(this.G):Te(_e),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void qn(this,t)}t=n||"";var i,o=new We(this.headers);r&&He(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Un,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=R.FormData&&t instanceof R.FormData,0<=j(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.B=(i=this.a,st&&gt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=oe(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){qn(this,t)}},T.ta=function(){void 0!==_&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),jn(this))},T.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),Vn.M.C.call(this)},T.va=function(){this.j||(this.w||this.l||this.g?Fn(this):this.Oa())},T.Oa=function(){Fn(this)},T.S=function(){try{return 2<Bn(this)?this.a.status:-1}catch(t){return-1}},T.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},T.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},T.qa=function(){return this.h},T.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(T=Wn.prototype).oa=8,T.u=1,T.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new Le(this,t,void 0),r=this.j;if(this.F&&(r?et(r=$(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),nn(i=Ze(this.v),"RID",t),nn(i,"CVER",22),this.s&&nn(i,"X-HTTP-Session-Id",this.s),Kn(this,i),this.h&&r&&zn(i,this.h,r),Nn(this.b,n),this.fa?(nn(i,"$req",e),nn(i,"SID","null"),n.R=!0,Pe(n,i,null)):Pe(n,i,e),this.u=2}}else 3==this.u&&(t?Zn(this,t):0==this.f.length||In(this.b)||Zn(this))},T.wa=function(){this.i=null,this.a=new Le(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Ze(this.ea);nn(t,"RID","rpc"),nn(t,"SID",this.B),nn(t,"CI",this.U?"0":"1"),nn(t,"AID",this.G),Kn(this,t),nn(t,"TYPE","xmlhttp"),this.h&&this.j&&zn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=rn(Ze(t)),e.j=null,e.F=!0,Ce(e,n)},T.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,er(this),me(19))},T.Ta=function(t){me(t?2:1)},(T=hr.prototype).na=function(){},T.ma=function(){},T.la=function(){},T.ka=function(){},T.Ha=function(){},cr.prototype.a=function(t,e){return new fr(t,e)},x(fr,zt),(T=fr.prototype).addEventListener=function(t,e,n,r){fr.M.addEventListener.call(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){fr.M.removeEventListener.call(this,t,e,n,r)},T.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.P=e,t.N=n||{},t.U=t.W,t.v=ar(t,null,t.P),Yn(t)},T.close=function(){Qn(this.a)},T.La=function(t){if("string"==typeof t){var e={};e.__data__=t,Jn(this.a,e)}else this.g?((e={}).__data__=Wt(t),Jn(this.a,e)):Jn(this.a,t)},T.C=function(){this.a.c=null,delete this.f,Qn(this.a),delete this.a,fr.M.C.call(this)},x(lr,Se),x(pr,De),x(dr,hr),dr.prototype.na=function(){this.a.dispatchEvent("a")},dr.prototype.ma=function(t){this.a.dispatchEvent(new lr(t))},dr.prototype.la=function(t){this.a.dispatchEvent(new pr)},dr.prototype.ka=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,fr.prototype.send=fr.prototype.La,fr.prototype.open=fr.prototype.Ka,fr.prototype.close=fr.prototype.close,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ne.EventType=Re).OPEN="a",Re.CLOSE="b",Re.ERROR="c",Re.MESSAGE="d",zt.prototype.listen=zt.prototype.ra,Vn.prototype.listenOnce=Vn.prototype.sa,Vn.prototype.getLastError=Vn.prototype.Ma,Vn.prototype.getLastErrorCode=Vn.prototype.qa,Vn.prototype.getStatus=Vn.prototype.S,Vn.prototype.getResponseJson=Vn.prototype.Ja,Vn.prototype.getResponseText=Vn.prototype.Y,Vn.prototype.send=Vn.prototype.$;var yr={createWebChannelTransport:function(){return new cr},ErrorCode:Ee,EventType:Ie,WebChannel:Ne,XhrIo:Vn},vr=yr.createWebChannelTransport,gr=yr.ErrorCode,mr=yr.EventType,wr=yr.WebChannel,br=yr.XhrIo,Er=cf.SDK_VERSION,Ir=(Ar.prototype.t=function(){return null!=this.uid},Ar.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Ar.prototype.isEqual=function(t){return t.uid===this.uid},Ar);function Ar(t){this.uid=t}Ir.UNAUTHENTICATED=new Ir(null),Ir.i=new Ir("google-credentials-uid"),Ir.h=new Ir("first-party-uid");function Tr(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}var Nr,_r,Rr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Sr=(n(Hr,_r=Error),Hr),Dr=(zr.prototype.getToken=function(){return Promise.resolve(null)},zr.prototype.l=function(){},zr.prototype._=function(t){(this.u=t)(Ir.UNAUTHENTICATED)},zr.prototype.T=function(){this.u=null},zr),kr=(Br.prototype.getToken=function(){var e=this,n=this.R,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.R!==n)throw new Sr(Rr.ABORTED,"getToken aborted due to token change.");return t?(Ks("string"==typeof t.accessToken),new Tr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Br.prototype.l=function(){this.forceRefresh=!0},Br.prototype._=function(t){this.u=t,this.I&&t(this.currentUser)},Br.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.m),this.m=null,this.u=null},Br.prototype.A=function(){var t=this.auth&&this.auth.getUid();return Ks(null===t||"string"==typeof t),new Ir(t)},Br),Lr=(Object.defineProperty(Gr.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Gr),Or=(jr.prototype.getToken=function(){return Promise.resolve(new Lr(this.P,this.V))},jr.prototype._=function(t){t(Ir.h)},jr.prototype.T=function(){},jr.prototype.l=function(){},jr),Vr=(Fr.now=function(){return Fr.fromMillis(Date.now())},Fr.fromDate=function(t){return Fr.fromMillis(t.getTime())},Fr.fromMillis=function(t){var e=Math.floor(t/1e3);return new Fr(e,1e6*(t-1e3*e))},Fr.prototype.toDate=function(){return new Date(this.toMillis())},Fr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Fr.prototype.g=function(t){return this.seconds===t.seconds?na(this.nanoseconds,t.nanoseconds):na(this.seconds,t.seconds)},Fr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Fr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Fr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Fr),Mr=(xr.v=function(t){return new xr(t)},xr.min=function(){return new xr(new Vr(0,0))},xr.prototype.S=function(t){return this.timestamp.g(t.timestamp)},xr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},xr.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},xr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},xr.prototype.D=function(){return this.timestamp},xr),Pr=(Object.defineProperty(qr.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),qr.prototype.isEqual=function(t){return 0===qr.N(this,t)},qr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof qr?t.forEach(function(t){e.push(t)}):e.push(t),this.$(e)},qr.prototype.limit=function(){return this.offset+this.length},qr.prototype.L=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},qr.prototype.k=function(){return this.$(this.segments,this.offset,this.length-1)},qr.prototype.O=function(){return this.segments[this.offset]},qr.prototype.q=function(){return this.get(this.length-1)},qr.prototype.get=function(t){return this.segments[this.offset+t]},qr.prototype.M=function(){return 0===this.length},qr.prototype.B=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},qr.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},qr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},qr.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},qr.N=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},qr),Cr=(n(Ur,Nr=Pr),Ur.prototype.$=function(t,e,n){return new Ur(t,e,n)},Ur.prototype.j=function(){return this.W().join("/")},Ur.prototype.toString=function(){return this.j()},Ur.G=function(t){if(0<=t.indexOf("//"))throw new Sr(Rr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Ur(t.split("/").filter(function(t){return 0<t.length}))},Ur);function Ur(){return null!==Nr&&Nr.apply(this,arguments)||this}function qr(t,e,n){void 0===e?e=0:e>t.length&&Zs(),void 0===n?n=t.length-e:n>t.length-e&&Zs(),this.segments=t,this.offset=e,this.F=n}function xr(t){this.timestamp=t}function Fr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Sr(Rr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Sr(Rr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Sr(Rr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Sr(Rr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function jr(t,e){this.P=t,this.V=e}function Gr(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=Ir.h}function Br(t){var e=this;this.m=null,this.currentUser=Ir.UNAUTHENTICATED,this.I=!1,this.R=0,this.u=null,this.forceRefresh=!1,this.m=function(){e.R++,e.currentUser=e.A(),e.I=!0,e.u&&e.u(e.currentUser)},this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.m):(this.m(null),t.get().then(function(t){e.auth=t,e.m&&e.auth.addAuthTokenListener(e.m)},function(){}))}function zr(){this.u=null}function Hr(t,e){var n=this;return(n=_r.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Cr.H=new Cr([]);var Wr,Qr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xr=(n(Jr,Wr=Pr),Jr.prototype.$=function(t,e,n){return new Jr(t,e,n)},Jr.K=function(t){return Qr.test(t)},Jr.prototype.j=function(){return this.W().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Jr.K(t)||(t="`"+t+"`"),t}).join(".")},Jr.prototype.toString=function(){return this.j()},Jr.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},Jr.X=function(){return new Jr(["__name__"])},Jr.J=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Sr(Rr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Sr(Rr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Sr(Rr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Jr(e)},Jr);function Jr(){return null!==Wr&&Wr.apply(this,arguments)||this}Xr.H=new Xr([]);var Yr=(Zr.Z=function(t){return new Zr(Cr.G(t).L(5))},Zr.prototype.tt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Zr.prototype.isEqual=function(t){return null!==t&&0===Cr.N(this.path,t.path)},Zr.prototype.toString=function(){return this.path.toString()},Zr.N=function(t,e){return Cr.N(t.path,e.path)},Zr.et=function(t){return t.length%2==0},Zr.st=function(t){return new Zr(new Cr(t.slice()))},Zr);function Zr(t){this.path=t}function Kr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function $r(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ti(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}Yr.EMPTY=new Yr(new Cr([]));var ei=(ni.fromBase64String=function(t){return new ni(Bs.nt().atob(t))},ni.fromUint8Array=function(t){return new ni(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},ni.prototype.toBase64=function(){return Bs.nt().btoa(this.it)},ni.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},ni.prototype.rt=function(){return 2*this.it.length},ni.prototype.S=function(t){return na(this.it,t.it)},ni.prototype.isEqual=function(t){return this.it===t.it},ni);function ni(t){this.it=t}function ri(t){return null==t}function ii(t){return-0===t&&1/t==-1/0}function oi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function si(t){var e=di(t.mapValue.fields.__local_write_time__.timestampValue);return new Vr(e.seconds,e.nanos)}ei.ht=new ei("");var ai=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ui(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?oi(t)?4:10:Zs()}function hi(i,t){var e,n,r,o=ui(i);if(o!==ui(t))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===t.booleanValue;case 4:return si(i).isEqual(si(t));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=di(i.timestampValue),n=di(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return i.stringValue===t.stringValue;case 6:return r=t,vi(i.bytesValue).isEqual(vi(r.bytesValue));case 7:return i.referenceValue===t.referenceValue;case 8:return n=t,yi((e=i).geoPointValue.latitude)===yi(n.geoPointValue.latitude)&&yi(e.geoPointValue.longitude)===yi(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return yi(t.integerValue)===yi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=yi(t.doubleValue),r=yi(e.doubleValue);return n===r?ii(n)===ii(r):isNaN(n)&&isNaN(r)}return!1}(i,t);case 9:return ra(i.arrayValue.values||[],t.arrayValue.values||[],hi);case 10:return function(t){var e=i.mapValue.fields||{},n=t.mapValue.fields||{};if(Kr(e)!==Kr(n))return!1;for(var r in e)if(e.hasOwnProperty(r)&&(void 0===n[r]||!hi(e[r],n[r])))return!1;return!0}(t);default:return Zs()}}function ci(t,e){return void 0!==(t.values||[]).find(function(t){return hi(t,e)})}function fi(t,e){var n,r,i,o,s,a,u,h,c,f,l=ui(t),p=ui(e);if(l!==p)return na(l,p);switch(l){case 0:return 0;case 1:return na(t.booleanValue,e.booleanValue);case 2:return h=e,c=yi(t.integerValue||t.doubleValue),f=yi(h.integerValue||h.doubleValue),c<f?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return li(t.timestampValue,e.timestampValue);case 4:return li(si(t),si(e));case 5:return na(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=vi(o),u=vi(s),a.S(u);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=na(n[i],r[i]);if(0!==o)return o}return na(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=na(yi(n.latitude),yi(r.latitude)))?i:na(yi(n.longitude),yi(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=fi(n[i],r[i]);if(o)return o}return na(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=na(r[s],o[s]);if(0!==a)return a;var u=fi(n[r[s]],i[o[s]]);if(0!==u)return u}return na(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Zs()}}function li(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return na(t,e);var n=di(t),r=di(e),i=na(n.seconds,r.seconds);return 0!==i?i:na(n.nanos,r.nanos)}function pi(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=di(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?vi(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Yr.Z(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Zs();var t,e,n}(t)}function di(t){if(Ks(!!t),"string"!=typeof t)return{seconds:yi(t.seconds),nanos:yi(t.nanos)};var e=0,n=ai.exec(t);if(Ks(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}function yi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function vi(t){return"string"==typeof t?ei.fromBase64String(t):ei.fromUint8Array(t)}function gi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function mi(t){return t&&"integerValue"in t}function wi(t){return!!t&&"arrayValue"in t}function bi(t){return t&&"nullValue"in t}function Ei(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ii(t){return t&&"mapValue"in t}var Ai=(Ti.prototype.ot=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Ti.prototype.at=function(t,e){return e},Ti.prototype.ut=function(t){return null},Ti.prototype.isEqual=function(t){return t instanceof Ti},Ti);function Ti(){}Ai.instance=new Ai;var Ni=(ki.prototype.ot=function(t,e){return this.apply(t)},ki.prototype.at=function(t,e){return this.apply(t)},ki.prototype.apply=function(t){for(var n=Li(t),e=function(e){n.some(function(t){return hi(t,e)})||n.push(e)},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},ki.prototype.ut=function(t){return null},ki.prototype.isEqual=function(t){return t instanceof ki&&ra(this.elements,t.elements,hi)},ki),_i=(Di.prototype.ot=function(t,e){return this.apply(t)},Di.prototype.at=function(t,e){return this.apply(t)},Di.prototype.apply=function(t){for(var n=Li(t),e=function(e){n=n.filter(function(t){return!hi(t,e)})},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},Di.prototype.ut=function(t){return null},Di.prototype.isEqual=function(t){return t instanceof Di&&ra(this.elements,t.elements,hi)},Di),Ri=(Si.prototype.ot=function(t,e){var n=this.ut(t),r=this.asNumber(n)+this.asNumber(this.ct);return mi(n)&&mi(this.ct)?this.serializer.lt(r):this.serializer._t(r)},Si.prototype.at=function(t,e){return e},Si.prototype.ut=function(t){return mi(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Si.prototype.isEqual=function(t){return t instanceof Si&&hi(this.ct,t.ct)},Si.prototype.asNumber=function(t){return yi(t.integerValue||t.doubleValue)},Si);function Si(t,e){this.serializer=t,this.ct=e}function Di(t){this.elements=t}function ki(t){this.elements=t}function Li(t){return wi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Oi(t,e){this.version=t,this.transformResults=e}var Vi,Mi,Pi,Ci,Ui,qi=(oo.prototype.ft=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].B(t))return!0;return!1},oo.prototype.isEqual=function(t){return ra(this.fields,t.fields,function(t,e){return t.isEqual(e)})},oo),xi=(io.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},io),Fi=(ro.dt=function(){return new ro},ro.exists=function(t){return new ro(void 0,t)},ro.updateTime=function(t){return new ro(t)},Object.defineProperty(ro.prototype,"wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),ro.prototype.Tt=function(t){return void 0!==this.updateTime?t instanceof Eo&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof Eo},ro.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ro),ji=(no.prototype.Et=function(t){},no.It=function(t){return t instanceof Eo?t.version:Mr.min()},no),Gi=(n(eo,Ui=ji),eo.prototype.at=function(t,e){this.Et(t);var n=e.version;return new Eo(this.key,n,this.value,{hasCommittedMutations:!0})},eo.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var r=ji.It(t);return new Eo(this.key,r,this.value,{At:!0})},eo.prototype.Pt=function(t){return null},eo.prototype.isEqual=function(t){return t instanceof eo&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},eo),Bi=(n(to,Ci=ji),to.prototype.at=function(t,e){if(this.Et(t),!this.Rt.Tt(t))return new Ao(this.key,e.version);var n=this.pt(t);return new Eo(this.key,e.version,n,{hasCommittedMutations:!0})},to.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var r=ji.It(t),i=this.pt(t);return new Eo(this.key,r,i,{At:!0})},to.prototype.Pt=function(t){return null},to.prototype.isEqual=function(t){return t instanceof to&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},to.prototype.pt=function(t){var e;return e=t instanceof Eo?t.data():Qi.empty(),this.yt(e)},to.prototype.yt=function(t){var n=this,r=new Xi(t);return this.Vt.fields.forEach(function(t){if(!t.M()){var e=n.data.field(t);null!==e?r.set(t,e):r.delete(t)}}),r.gt()},to),zi=(n($i,Pi=ji),$i.prototype.at=function(t,e){if(this.Et(t),Ks(null!=e.transformResults),!this.Rt.Tt(t))return new Ao(this.key,e.version);var n=this.bt(t),r=this.vt(t,e.transformResults),i=e.version,o=this.St(n.data(),r);return new Eo(this.key,i,o,{hasCommittedMutations:!0})},$i.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var r=this.bt(t),i=this.Ct(n,t,e),o=this.St(r.data(),i);return new Eo(this.key,r.version,o,{At:!0})},$i.prototype.Pt=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Eo?t.field(i.field):void 0,s=i.transform.ut(o||null);null!=s&&(e=null==e?(new Xi).set(i.field,s):e.set(i.field,s))}return e?e.gt():null},$i.prototype.isEqual=function(t){return t instanceof $i&&this.key.isEqual(t.key)&&ra(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Rt.isEqual(t.Rt)},$i.prototype.bt=function(t){return t},$i.prototype.vt=function(t,e){var n=[];Ks(this.fieldTransforms.length===e.length);for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof Eo&&(s=t.field(i.field)),n.push(o.at(s,e[r]))}return n},$i.prototype.Ct=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],a=s.transform,u=null;e instanceof Eo&&(u=e.field(s.field)),null===u&&n instanceof Eo&&(u=n.field(s.field)),r.push(a.ot(u,t))}return r},$i.prototype.St=function(t,e){for(var n=new Xi(t),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.gt()},$i),Hi=(n(Ki,Mi=ji),Ki.prototype.at=function(t,e){return this.Et(t),new Io(this.key,e.version,{hasCommittedMutations:!0})},Ki.prototype.ot=function(t,e,n){return this.Et(t),this.Rt.Tt(t)?new Io(this.key,Mr.min()):t},Ki.prototype.Pt=function(t){return null},Ki.prototype.isEqual=function(t){return t instanceof Ki&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Ki),Wi=(n(Zi,Vi=ji),Zi.prototype.at=function(t,e){Zs()},Zi.prototype.ot=function(t,e,n){Zs()},Zi.prototype.Pt=function(t){Zs()},Zi.prototype.isEqual=function(t){return t instanceof Zi&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Zi),Qi=(Yi.empty=function(){return new Yi({mapValue:{}})},Yi.prototype.field=function(t){if(t.M())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ii(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.q()])||null},Yi.prototype.isEqual=function(t){return hi(this.proto,t.proto)},Yi),Xi=(Ji.prototype.set=function(t,e){return this.Nt(t,e),this},Ji.prototype.delete=function(t){return this.Nt(t,null),this},Ji.prototype.Nt=function(t,e){for(var n=this.Ft,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===ui(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.q(),e)},Ji.prototype.gt=function(){var t=this.$t(Xr.H,this.Ft);return null!=t?new Qi(t):this.Dt},Ji.prototype.$t=function(r,t){var i=this,o=!1,e=this.Dt.field(r),s=Ii(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=i.$t(r.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ji);function Ji(t){void 0===t&&(t=Qi.empty()),this.Dt=t,this.Ft=new Map}function Yi(t){this.proto=t}function Zi(t,e){var n=this;return(n=Vi.call(this)||this).key=t,n.Rt=e,n.type=4,n}function Ki(t,e){var n=this;return(n=Mi.call(this)||this).key=t,n.Rt=e,n.type=3,n}function $i(t,e){var n=this;return(n=Pi.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Rt=Fi.exists(!0),n}function to(t,e,n,r){var i=this;return(i=Ci.call(this)||this).key=t,i.data=e,i.Vt=n,i.Rt=r,i.type=1,i}function eo(t,e,n){var r=this;return(r=Ui.call(this)||this).key=t,r.value=e,r.Rt=n,r.type=0,r}function no(){}function ro(t,e){this.updateTime=t,this.exists=e}function io(t,e){this.field=t,this.transform=e}function oo(t){(this.fields=t).sort(Xr.N)}function so(t){var a=[];return $r(t.fields||{},function(t,e){var n=new Xr([t]);if(Ii(e)){var r=so(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new qi(a)}function ao(t,e){this.key=t,this.version=e}function uo(t){this.count=t}var ho,co,fo,lo,po,yo,vo,go,mo,wo,bo,Eo=(n(Xo,bo=ao),Xo.prototype.field=function(t){return this.Lt.field(t)},Xo.prototype.data=function(){return this.Lt},Xo.prototype.kt=function(){return this.Lt.proto},Xo.prototype.isEqual=function(t){return t instanceof Xo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Lt.isEqual(t.Lt)},Xo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Lt.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Xo.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Xo),Io=(n(Qo,wo=ao),Qo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Qo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Qo.prototype.isEqual=function(t){return t instanceof Qo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Qo),Ao=(n(Wo,mo=ao),Wo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Wo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Wo.prototype.isEqual=function(t){return t instanceof Wo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Wo),To=(Ho.prototype.canonicalId=function(){if(null===this.Ot){var t=this.path.j();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),ri(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Ot=t}return this.Ot},Ho.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),ri(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Ho.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Ho.prototype.qt=function(){return Yr.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},Ho),No=(zo.Wt=function(t){return new zo(t)},Object.defineProperty(zo.prototype,"orderBy",{get:function(){if(null===this.Bt){this.Bt=[];var t=this.jt(),e=this.Gt();if(null!==t&&null===e)t.Y()||this.Bt.push(new Vo(t)),this.Bt.push(new Vo(Xr.X(),"asc"));else{for(var n=!1,r=0,i=this.Mt;r<i.length;r++){var o=i[r];this.Bt.push(o),o.field.Y()&&(n=!0)}if(!n){var s=0<this.Mt.length?this.Mt[this.Mt.length-1].dir:"asc";this.Bt.push(new Vo(Xr.X(),s))}}}return this.Bt},enumerable:!0,configurable:!0}),zo.prototype.Ht=function(t){var e=this.filters.concat([t]);return new zo(this.path,this.collectionGroup,this.Mt.slice(),e,this.limit,this.xt,this.startAt,this.endAt)},zo.prototype.Kt=function(t){var e=this.Mt.concat([t]);return new zo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},zo.prototype.zt=function(t){return new zo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},zo.prototype.Yt=function(t){return new zo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},zo.prototype.Xt=function(t){return new zo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,t,this.endAt)},zo.prototype.Jt=function(t){return new zo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,t)},zo.prototype.Zt=function(t){return new zo(t,null,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},zo.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Mt.length||1===this.Mt.length&&this.Mt[0].field.Y())},zo.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.xt},zo.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.xt+")"},zo.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.xt===t.xt},zo.prototype.se=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},zo.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},zo.prototype.oe=function(){return!ri(this.limit)&&"F"===this.xt},zo.prototype.ae=function(){return!ri(this.limit)&&"L"===this.xt},zo.prototype.Gt=function(){return 0<this.Mt.length?this.Mt[0].field:null},zo.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof _o&&n.ue())return n.field}return null},zo.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof _o&&0<=t.indexOf(r.op))return r.op}return null},zo.prototype.qt=function(){return this.ee().qt()},zo.prototype.le=function(){return null!==this.collectionGroup},zo.prototype.ee=function(){if(!this.Ut)if("F"===this.xt)this.Ut=new To(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new Vo(r.field,i))}var o=this.endAt?new Oo(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Oo(this.startAt.position,!this.startAt.before):null;this.Ut=new To(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},zo.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.B(e):Yr.et(this.path)?this.path.isEqual(e):this.path.U(e)},zo.prototype.ne=function(t){for(var e=0,n=this.Mt;e<n.length;e++){var r=n[e];if(!r.field.Y()&&null===t.field(r.field))return!1}return!0},zo.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},zo.prototype.he=function(t){return!(this.startAt&&!this.startAt._e(this.orderBy,t)||this.endAt&&this.endAt._e(this.orderBy,t))},zo.prototype.Qt=function(t){},zo),_o=(n(Bo,go=function(){}),Bo.create=function(t,e,n){if(t.Y())return"in"===e?new So(t,n):new Ro(t,e,n);if(bi(n)){if("=="!==e)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Bo(t,e,n)}if(Ei(n)){if("=="!==e)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Bo(t,e,n)}return"array-contains"===e?new Do(t,n):"in"===e?new ko(t,n):"array-contains-any"===e?new Lo(t,n):new Bo(t,e,n)},Bo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ui(this.value)===ui(e)&&this.fe(fi(e,this.value))},Bo.prototype.fe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Zs()}},Bo.prototype.ue=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Bo.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+pi(this.value)},Bo.prototype.isEqual=function(t){return t instanceof Bo&&this.op===t.op&&this.field.isEqual(t.field)&&hi(this.value,t.value)},Bo.prototype.toString=function(){return this.field.j()+" "+this.op+" "+pi(this.value)},Bo),Ro=(n(Go,vo=_o),Go.prototype.matches=function(t){var e=Yr.N(t.key,this.key);return this.fe(e)},Go),So=(n(jo,yo=_o),jo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},jo),Do=(n(Fo,po=_o),Fo.prototype.matches=function(t){var e=t.field(this.field);return wi(e)&&ci(e.arrayValue,this.value)},Fo),ko=(n(xo,lo=_o),xo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ci(this.value.arrayValue,e)},xo),Lo=(n(qo,fo=_o),qo.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!wi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return ci(e.value.arrayValue,t)})},qo),Oo=(Uo.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return pi(t)}).join(",")},Uo.prototype._e=function(t,e){for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(n=i.field.Y()?Yr.N(Yr.Z(o.referenceValue),e.key):fi(o,e.field(i.field)),"desc"===i.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Uo.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!hi(this.position[e],t.position[e]))return!1;return!0},Uo),Vo=(Co.prototype.compare=function(t,e){var n,r,i,o,s=this.de?Yr.N(t.key,e.key):(n=this.field,r=e,i=t.field(n),o=r.field(n),null!==i&&null!==o?fi(i,o):Zs());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return Zs()}},Co.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},Co.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},Co.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Co),Mo=(Po.prototype.Ee=function(t){return new Po(this.target,this.targetId,this.we,t,this.Te,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Po.prototype.me=function(t,e){return new Po(this.target,this.targetId,this.we,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Po.prototype.Ie=function(t){return new Po(this.target,this.targetId,this.we,this.sequenceNumber,this.Te,t,this.resumeToken)},Po);function Po(t,e,n,r,i,o,s){void 0===i&&(i=Mr.min()),void 0===o&&(o=Mr.min()),void 0===s&&(s=ei.ht),this.target=t,this.targetId=e,this.we=n,this.sequenceNumber=r,this.Te=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Co(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.de=t.Y()}function Uo(t,e){this.position=t,this.before=e}function qo(t,e){return fo.call(this,t,"array-contains-any",e)||this}function xo(t,e){return lo.call(this,t,"in",e)||this}function Fo(t,e){return po.call(this,t,"array-contains",e)||this}function jo(t,e){var n=this;return(n=yo.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Yr.Z(t.referenceValue)}),n}function Go(t,e,n){var r=this;return(r=vo.call(this,t,e,n)||this).key=Yr.Z(n.referenceValue),r}function Bo(t,e,n){var r=this;return(r=go.call(this)||this).field=t,r.op=e,r.value=n,r}function zo(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.Mt=n,this.filters=r,this.limit=i,this.xt=o,this.startAt=s,this.endAt=a,this.Bt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}function Ho(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Ot=null}function Wo(){return null!==mo&&mo.apply(this,arguments)||this}function Qo(t,e,n){var r=this;return(r=wo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Xo(t,e,n,r){var i=this;return(i=bo.call(this,t,e)||this).Lt=n,i.At=!!r.At,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Jo(t){switch(t){case Rr.OK:return Zs();case Rr.CANCELLED:case Rr.UNKNOWN:case Rr.DEADLINE_EXCEEDED:case Rr.RESOURCE_EXHAUSTED:case Rr.INTERNAL:case Rr.UNAVAILABLE:case Rr.UNAUTHENTICATED:return;case Rr.INVALID_ARGUMENT:case Rr.NOT_FOUND:case Rr.ALREADY_EXISTS:case Rr.PERMISSION_DENIED:case Rr.FAILED_PRECONDITION:case Rr.ABORTED:case Rr.OUT_OF_RANGE:case Rr.UNIMPLEMENTED:case Rr.DATA_LOSS:return 1;default:return Zs()}}function Yo(t){if(void 0===t)return Js("GRPC error has no .code"),Rr.UNKNOWN;switch(t){case ho.OK:return Rr.OK;case ho.CANCELLED:return Rr.CANCELLED;case ho.UNKNOWN:return Rr.UNKNOWN;case ho.DEADLINE_EXCEEDED:return Rr.DEADLINE_EXCEEDED;case ho.RESOURCE_EXHAUSTED:return Rr.RESOURCE_EXHAUSTED;case ho.INTERNAL:return Rr.INTERNAL;case ho.UNAVAILABLE:return Rr.UNAVAILABLE;case ho.UNAUTHENTICATED:return Rr.UNAUTHENTICATED;case ho.INVALID_ARGUMENT:return Rr.INVALID_ARGUMENT;case ho.NOT_FOUND:return Rr.NOT_FOUND;case ho.ALREADY_EXISTS:return Rr.ALREADY_EXISTS;case ho.PERMISSION_DENIED:return Rr.PERMISSION_DENIED;case ho.FAILED_PRECONDITION:return Rr.FAILED_PRECONDITION;case ho.ABORTED:return Rr.ABORTED;case ho.OUT_OF_RANGE:return Rr.OUT_OF_RANGE;case ho.UNIMPLEMENTED:return Rr.UNIMPLEMENTED;case ho.DATA_LOSS:return Rr.DATA_LOSS;default:return Zs()}}(co=ho=ho||{})[co.OK=0]="OK",co[co.CANCELLED=1]="CANCELLED",co[co.UNKNOWN=2]="UNKNOWN",co[co.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",co[co.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",co[co.NOT_FOUND=5]="NOT_FOUND",co[co.ALREADY_EXISTS=6]="ALREADY_EXISTS",co[co.PERMISSION_DENIED=7]="PERMISSION_DENIED",co[co.UNAUTHENTICATED=16]="UNAUTHENTICATED",co[co.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",co[co.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",co[co.ABORTED=10]="ABORTED",co[co.OUT_OF_RANGE=11]="OUT_OF_RANGE",co[co.UNIMPLEMENTED=12]="UNIMPLEMENTED",co[co.INTERNAL=13]="INTERNAL",co[co.UNAVAILABLE=14]="UNAVAILABLE",co[co.DATA_LOSS=15]="DATA_LOSS";var Zo=(ns.prototype.Re=function(t,e){return new ns(this.N,this.root.Re(t,e,this.N).Ae(null,null,$o.Pe,null,null))},ns.prototype.remove=function(t){return new ns(this.N,this.root.remove(t,this.N).Ae(null,null,$o.Pe,null,null))},ns.prototype.get=function(t){for(var e=this.root;!e.M();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ns.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.M();){var r=this.N(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},ns.prototype.M=function(){return this.root.M()},Object.defineProperty(ns.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),ns.prototype.Ve=function(){return this.root.Ve()},ns.prototype.pe=function(){return this.root.pe()},ns.prototype.ye=function(t){return this.root.ye(t)},ns.prototype.forEach=function(n){this.ye(function(t,e){return n(t,e),!1})},ns.prototype.toString=function(){var n=[];return this.ye(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ns.prototype.ge=function(t){return this.root.ge(t)},ns.prototype.be=function(){return new Ko(this.root,null,this.N,!1)},ns.prototype.ve=function(t){return new Ko(this.root,t,this.N,!1)},ns.prototype.Se=function(){return new Ko(this.root,null,this.N,!0)},ns.prototype.Ce=function(t){return new Ko(this.root,t,this.N,!0)},ns),Ko=(es.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.De)for(t=t.left;!t.M();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.M();)this.Fe.push(t),t=t.left;return e},es.prototype.$e=function(){return 0<this.Fe.length},es.prototype.Le=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},es),$o=(ts.prototype.Ae=function(t,e,n,r,i){return new ts(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},ts.prototype.M=function(){return!1},ts.prototype.ye=function(t){return this.left.ye(t)||t(this.key,this.value)||this.right.ye(t)},ts.prototype.ge=function(t){return this.right.ge(t)||t(this.key,this.value)||this.left.ge(t)},ts.prototype.min=function(){return this.left.M()?this:this.left.min()},ts.prototype.Ve=function(){return this.min().key},ts.prototype.pe=function(){return this.right.M()?this.key:this.right.pe()},ts.prototype.Re=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.Ae(null,null,null,r.left.Re(t,e,n),null):0===i?r.Ae(null,e,null,null,null):r.Ae(null,null,null,null,r.right.Re(t,e,n))).ke()},ts.prototype.Oe=function(){if(this.left.M())return ts.EMPTY;var t=this;return t.left.qe()||t.left.left.qe()||(t=t.Me()),(t=t.Ae(null,null,null,t.left.Oe(),null)).ke()},ts.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.M()||r.left.qe()||r.left.left.qe()||(r=r.Me()),r=r.Ae(null,null,null,r.left.remove(t,e),null);else{if(r.left.qe()&&(r=r.xe()),r.right.M()||r.right.qe()||r.right.left.qe()||(r=r.Be()),0===e(t,r.key)){if(r.right.M())return ts.EMPTY;n=r.right.min(),r=r.Ae(n.key,n.value,null,null,r.right.Oe())}r=r.Ae(null,null,null,null,r.right.remove(t,e))}return r.ke()},ts.prototype.qe=function(){return this.color},ts.prototype.ke=function(){var t=this;return t.right.qe()&&!t.left.qe()&&(t=t.Ue()),t.left.qe()&&t.left.left.qe()&&(t=t.xe()),t.left.qe()&&t.right.qe()&&(t=t.Qe()),t},ts.prototype.Me=function(){var t=this.Qe();return t.right.left.qe()&&(t=(t=(t=t.Ae(null,null,null,null,t.right.xe())).Ue()).Qe()),t},ts.prototype.Be=function(){var t=this.Qe();return t.left.left.qe()&&(t=(t=t.xe()).Qe()),t},ts.prototype.Ue=function(){var t=this.Ae(null,null,ts.RED,null,this.right.left);return this.right.Ae(null,null,this.color,t,null)},ts.prototype.xe=function(){var t=this.Ae(null,null,ts.RED,this.left.right,null);return this.left.Ae(null,null,this.color,null,t)},ts.prototype.Qe=function(){var t=this.left.Ae(null,null,!this.left.color,null,null),e=this.right.Ae(null,null,!this.right.color,null,null);return this.Ae(null,null,!this.color,t,e)},ts.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},ts.prototype.je=function(){if(this.qe()&&this.left.qe())throw Zs();if(this.right.qe())throw Zs();var t=this.left.je();if(t!==this.right.je())throw Zs();return t+(this.qe()?0:1)},ts);function ts(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:ts.RED,this.left=null!=r?r:ts.EMPTY,this.right=null!=i?i:ts.EMPTY,this.size=this.left.size+1+this.right.size}function es(t,e,n,r){this.De=r,this.Fe=[];for(var i=1;!t.M();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.De?t.left:t.right;else{if(0===i){this.Fe.push(t);break}this.Fe.push(t),t=this.De?t.right:t.left}}function ns(t,e){this.N=t,this.root=e||$o.EMPTY}function rs(){this.size=0}$o.EMPTY=null,$o.RED=!0,$o.Pe=!1,$o.EMPTY=(Object.defineProperty(rs.prototype,"key",{get:function(){throw Zs()},enumerable:!0,configurable:!0}),Object.defineProperty(rs.prototype,"value",{get:function(){throw Zs()},enumerable:!0,configurable:!0}),Object.defineProperty(rs.prototype,"color",{get:function(){throw Zs()},enumerable:!0,configurable:!0}),Object.defineProperty(rs.prototype,"left",{get:function(){throw Zs()},enumerable:!0,configurable:!0}),Object.defineProperty(rs.prototype,"right",{get:function(){throw Zs()},enumerable:!0,configurable:!0}),rs.prototype.Ae=function(t,e,n,r,i){return this},rs.prototype.Re=function(t,e,n){return new $o(t,e)},rs.prototype.remove=function(t,e){return this},rs.prototype.M=function(){return!0},rs.prototype.ye=function(t){return!1},rs.prototype.ge=function(t){return!1},rs.prototype.Ve=function(){return null},rs.prototype.pe=function(){return null},rs.prototype.qe=function(){return!1},rs.prototype.We=function(){return!0},rs.prototype.je=function(){return 0},new rs);var is=(us.prototype.has=function(t){return null!==this.data.get(t)},us.prototype.first=function(){return this.data.Ve()},us.prototype.last=function(){return this.data.pe()},Object.defineProperty(us.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),us.prototype.indexOf=function(t){return this.data.indexOf(t)},us.prototype.forEach=function(n){this.data.ye(function(t,e){return n(t),!1})},us.prototype.Ge=function(t,e){for(var n=this.data.ve(t[0]);n.$e();){var r=n.Ne();if(0<=this.N(r.key,t[1]))return;e(r.key)}},us.prototype.He=function(t,e){var n;for(n=void 0!==e?this.data.ve(e):this.data.be();n.$e();)if(!t(n.Ne().key))return},us.prototype.Ke=function(t){var e=this.data.ve(t);return e.$e()?e.Ne().key:null},us.prototype.be=function(){return new os(this.data.be())},us.prototype.ve=function(t){return new os(this.data.ve(t))},us.prototype.add=function(t){return this.Ae(this.data.remove(t).Re(t,!0))},us.prototype.delete=function(t){return this.has(t)?this.Ae(this.data.remove(t)):this},us.prototype.M=function(){return this.data.M()},us.prototype.ze=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},us.prototype.isEqual=function(t){if(!(t instanceof us))return!1;if(this.size!==t.size)return!1;for(var e=this.data.be(),n=t.data.be();e.$e();){var r=e.Ne().key,i=n.Ne().key;if(0!==this.N(r,i))return!1}return!0},us.prototype.W=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},us.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},us.prototype.Ae=function(t){var e=new us(this.N);return e.data=t,e},us),os=(as.prototype.Ne=function(){return this.Ye.Ne().key},as.prototype.$e=function(){return this.Ye.$e()},as),ss=new Zo(Yr.N);function as(t){this.Ye=t}function us(t){this.N=t,this.data=new Zo(this.N)}function hs(){return ss}function cs(){return hs()}var fs=new Zo(Yr.N);function ls(){return fs}var ps=new Zo(Yr.N);function ds(){return ps}var ys=new is(Yr.N);function vs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ys,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var gs=new is(na);function ms(){return gs}function ws(t,e,n,r){this.ms=t,this.removedTargetIds=e,this.key=n,this.Is=r}function bs(t,e){this.targetId=t,this.Rs=e}function Es(t,e,n,r){void 0===n&&(n=ei.ht),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Is=(Ps.Ze=function(t){return new Ps(t.N)},Ps.prototype.has=function(t){return null!=this.Xe.get(t)},Ps.prototype.get=function(t){return this.Xe.get(t)},Ps.prototype.first=function(){return this.Je.Ve()},Ps.prototype.last=function(){return this.Je.pe()},Ps.prototype.M=function(){return this.Je.M()},Ps.prototype.indexOf=function(t){var e=this.Xe.get(t);return e?this.Je.indexOf(e):-1},Object.defineProperty(Ps.prototype,"size",{get:function(){return this.Je.size},enumerable:!0,configurable:!0}),Ps.prototype.forEach=function(n){this.Je.ye(function(t,e){return n(t),!1})},Ps.prototype.add=function(t){var e=this.delete(t.key);return e.Ae(e.Xe.Re(t.key,t),e.Je.Re(t,null))},Ps.prototype.delete=function(t){var e=this.get(t);return e?this.Ae(this.Xe.remove(t),this.Je.remove(e)):this},Ps.prototype.isEqual=function(t){if(!(t instanceof Ps))return!1;if(this.size!==t.size)return!1;for(var e=this.Je.be(),n=t.Je.be();e.$e();){var r=e.Ne().key,i=n.Ne().key;if(!r.isEqual(i))return!1}return!0},Ps.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ps.prototype.Ae=function(t,e){var n=new Ps;return n.N=this.N,n.Xe=t,n.Je=e,n},Ps),As=(Ms.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);!n||0!==t.type&&3===n.type?this.ts=this.ts.Re(e,t):3===t.type&&1!==n.type?this.ts=this.ts.Re(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.Re(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):Zs()},Ms.prototype.es=function(){var n=[];return this.ts.ye(function(t,e){n.push(e)}),n},Ms),Ts=(Vs.os=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Vs(t,e,Is.Ze(e),i,n,r,!0,!1)},Object.defineProperty(Vs.prototype,"hasPendingWrites",{get:function(){return!this.ns.M()},enumerable:!0,configurable:!0}),Vs.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Vs),Ns=(Os._s=function(t,e){var n=new Map;return n.set(t,_s.fs(t,e)),new Os(Mr.min(),n,ms(),hs(),vs())},Os),_s=(Ls.fs=function(t,e){return new Ls(ei.ht,e,vs(),vs(),vs())},Ls),Rs=(Object.defineProperty(ks.prototype,"ds",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Object.defineProperty(ks.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(ks.prototype,"gs",{get:function(){return 0!==this.As},enumerable:!0,configurable:!0}),Object.defineProperty(ks.prototype,"bs",{get:function(){return this.ys},enumerable:!0,configurable:!0}),ks.prototype.vs=function(t){0<t.rt()&&(this.ys=!0,this.Vs=t)},ks.prototype.Ss=function(){var n=vs(),r=vs(),i=vs();return this.Ps.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Zs()}}),new _s(this.Vs,this.ps,n,r,i)},ks.prototype.Cs=function(){this.ys=!1,this.Ps=Us()},ks.prototype.Ds=function(t,e){this.ys=!0,this.Ps=this.Ps.Re(t,e)},ks.prototype.Fs=function(t){this.ys=!0,this.Ps=this.Ps.remove(t)},ks.prototype.Ns=function(){this.As+=1},ks.prototype.$s=function(){--this.As},ks.prototype.Ls=function(){this.ys=!0,this.ps=!0},ks),Ss=(Ds.prototype.Bs=function(t){for(var e=0,n=t.ms;e<n.length;e++){var r=n[e];t.Is instanceof Eo?this.Us(r,t.Is):t.Is instanceof Io&&this.Qs(r,t.key,t.Is)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Qs(s,t.key,t.Is)}},Ds.prototype.Ws=function(n){var r=this;this.js(n,function(t){var e=r.Gs(t);switch(n.state){case 0:r.Hs(t)&&e.vs(n.resumeToken);break;case 1:e.$s(),e.gs||e.Cs(),e.vs(n.resumeToken);break;case 2:e.$s(),e.gs||r.removeTarget(t);break;case 3:r.Hs(t)&&(e.Ls(),e.vs(n.resumeToken));break;case 4:r.Hs(t)&&(r.Ks(t),e.vs(n.resumeToken));break;default:Zs()}})},Ds.prototype.js=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Os.forEach(function(t,e){r.Hs(e)&&n(e)})},Ds.prototype.zs=function(t){var e=t.targetId,n=t.Rs.count,r=this.Ys(e);if(r){var i=r.target;if(i.qt())if(0===n){var o=new Yr(i.path);this.Qs(e,o,new Io(o,Mr.min()))}else Ks(1===n);else this.Xs(e)!==n&&(this.Ks(e),this.xs=this.xs.add(e))}},Ds.prototype.Js=function(i){var o=this,s=new Map;this.Os.forEach(function(t,e){var n=o.Ys(e);if(n){if(t.ds&&n.target.qt()){var r=new Yr(n.target.path);null!==o.qs.get(r)||o.Zs(e,r)||o.Qs(e,r,new Io(r,i))}t.bs&&(s.set(e,t.Ss()),t.Cs())}});var r=vs();this.Ms.forEach(function(t,e){var n=!0;e.He(function(t){var e=o.Ys(t);return!e||2===e.we||(n=!1)}),n&&(r=r.add(t))});var t=new Ns(i,s,this.xs,this.qs,r);return this.qs=hs(),this.Ms=Cs(),this.xs=new is(na),t},Ds.prototype.Us=function(t,e){if(this.Hs(t)){var n=this.Zs(t,e.key)?2:0;this.Gs(t).Ds(e.key,n),this.qs=this.qs.Re(e.key,e),this.Ms=this.Ms.Re(e.key,this.ti(e.key).add(t))}},Ds.prototype.Qs=function(t,e,n){if(this.Hs(t)){var r=this.Gs(t);this.Zs(t,e)?r.Ds(e,1):r.Fs(e),this.Ms=this.Ms.Re(e,this.ti(e).delete(t)),n&&(this.qs=this.qs.Re(e,n))}},Ds.prototype.removeTarget=function(t){this.Os.delete(t)},Ds.prototype.Xs=function(t){var e=this.Gs(t).Ss();return this.ks.ei(t).size+e.ws.size-e.Es.size},Ds.prototype.Ns=function(t){this.Gs(t).Ns()},Ds.prototype.Gs=function(t){var e=this.Os.get(t);return e||(e=new Rs,this.Os.set(t,e)),e},Ds.prototype.ti=function(t){var e=this.Ms.get(t);return e||(e=new is(na),this.Ms=this.Ms.Re(t,e)),e},Ds.prototype.Hs=function(t){var e=null!==this.Ys(t);return e||Xs("WatchChangeAggregator","Detected inactive target",t),e},Ds.prototype.Ys=function(t){var e=this.Os.get(t);return e&&e.gs?null:this.ks.si(t)},Ds.prototype.Ks=function(e){var n=this;this.Os.set(e,new Rs),this.ks.ei(e).forEach(function(t){n.Qs(e,t,null)})},Ds.prototype.Zs=function(t,e){return this.ks.ei(t).has(e)},Ds);function Ds(t){this.ks=t,this.Os=new Map,this.qs=hs(),this.Ms=Cs(),this.xs=new is(na)}function ks(){this.As=0,this.Ps=Us(),this.Vs=ei.ht,this.ps=!1,this.ys=!0}function Ls(t,e,n,r,i){this.resumeToken=t,this.ds=e,this.ws=n,this.Ts=r,this.Es=i}function Os(t,e,n,r,i){this.Te=t,this.as=e,this.us=n,this.cs=r,this.ls=i}function Vs(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.ss=n,this.docChanges=r,this.ns=i,this.fromCache=o,this.rs=s,this.hs=a}function Ms(){this.ts=new Zo(Yr.N)}function Ps(n){this.N=n?function(t,e){return n(t,e)||Yr.N(t.key,e.key)}:function(t,e){return Yr.N(t.key,e.key)},this.Xe=ls(),this.Je=new Zo(this.N)}function Cs(){return new Zo(Yr.N)}function Us(){return new Zo(Yr.N)}var qs={asc:"ASCENDING",desc:"DESCENDING"},xs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Fs=(js.prototype.ni=function(t){var e=void 0===t.code?Rr.UNKNOWN:Yo(t.code);return new Sr(e,t.message||"")},js.prototype.ri=function(t){return this.options.hi||ri(t)?t:{value:t}},js.prototype.oi=function(t){var e;return ri(e="object"==typeof t?t.value:t)?null:e},js.prototype.lt=function(t){return{integerValue:""+t}},js.prototype._t=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ii(t)?"-0":t}},js.prototype.ai=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!ii(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.lt(t):this._t(t);var e},js.prototype.D=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},js.prototype.v=function(t){var e=di(t);return new Vr(e.seconds,e.nanos)},js.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},js.prototype.ci=function(t){return this.options.hi?(Ks(void 0===t||"string"==typeof t),ei.fromBase64String(t||"")):(Ks(void 0===t||t instanceof Uint8Array),ei.fromUint8Array(t||new Uint8Array))},js.prototype.toVersion=function(t){return this.D(t.D())},js.prototype.fromVersion=function(t){return Ks(!!t),Mr.v(this.v(t))},js.prototype.li=function(t,e){return this._i(e||this.ii).child("documents").child(t).j()},js.prototype.fi=function(t){var e=Cr.G(t);return Ks(Gs(e)),e},js.prototype.di=function(t){return this.li(t.path)},js.prototype.Z=function(t){var e=this.fi(t);return Ks(e.get(1)===this.ii.projectId),Ks(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new Yr(this.wi(e))},js.prototype.Ti=function(t){return this.li(t)},js.prototype.Ei=function(t){var e=this.fi(t);return 4===e.length?Cr.H:this.wi(e)},Object.defineProperty(js.prototype,"mi",{get:function(){return new Cr(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),js.prototype._i=function(t){return new Cr(["projects",t.projectId,"databases",t.database])},js.prototype.wi=function(t){return Ks(4<t.length&&"documents"===t.get(4)),t.L(5)},js.prototype.Ii=function(t,e){return{name:this.di(t),fields:e.proto.mapValue.fields}},js.prototype.Ri=function(t){return{name:this.di(t.key),fields:t.kt().mapValue.fields,updateTime:this.D(t.version.D())}},js.prototype.Ai=function(t,e){var n=this.Z(t.name),r=this.fromVersion(t.updateTime),i=new Qi({mapValue:{fields:t.fields}});return new Eo(n,r,i,{hasCommittedMutations:!!e})},js.prototype.Pi=function(t){Ks(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),r=new Qi({mapValue:{fields:t.found.fields}});return new Eo(e,n,r,{})},js.prototype.Vi=function(t){Ks(!!t.missing),Ks(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new Io(e,n)},js.prototype.pi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):Zs()},js.prototype.yi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.gi(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],i=this.ci(t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&this.ni(o);e=new Es(n,r,i,s||null)}else if("documentChange"in t){t.documentChange;var a=t.documentChange;a.document,a.document.name,a.document.updateTime;var u=this.Z(a.document.name),h=this.fromVersion(a.document.updateTime),c=new Qi({mapValue:{fields:a.document.fields}}),f=new Eo(u,h,c,{}),l=a.targetIds||[],p=a.removedTargetIds||[];e=new ws(l,p,f.key,f)}else if("documentDelete"in t){t.documentDelete;var d=t.documentDelete;d.document;var y=this.Z(d.document),v=d.readTime?this.fromVersion(d.readTime):Mr.min(),g=new Io(y,v),m=d.removedTargetIds||[];e=new ws([],m,g.key,g)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var b=this.Z(w.document),E=w.removedTargetIds||[];e=new ws([],E,b,null)}else{if(!("filter"in t))return Zs();t.filter;var I=t.filter;I.targetId;var A=I.count||0,T=new uo(A),N=I.targetId;e=new bs(N,T)}return e},js.prototype.gi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Zs()},js.prototype.bi=function(t){if(!("targetChange"in t))return Mr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Mr.min():this.fromVersion(e.readTime)},js.prototype.vi=function(t){var e,n=this;if(t instanceof Gi)e={update:this.Ii(t.key,t.value)};else if(t instanceof Hi)e={delete:this.di(t.key)};else if(t instanceof Bi)e={update:this.Ii(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof zi)e={transform:{document:this.di(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Ci(t)})}};else{if(!(t instanceof Wi))return Zs();e={verify:this.di(t.key)}}return t.Rt.wt||(e.currentDocument=this.Di(t.Rt)),e},js.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):Fi.dt();if(t.update){t.update.name;var r=this.Z(t.update.name),i=new Qi({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.$i(t.updateMask);return new Bi(r,i,o,n)}return new Gi(r,i,n)}if(t.delete){var s=this.Z(t.delete);return new Hi(s,n)}if(t.transform){var a=this.Z(t.transform.document),u=t.transform.fieldTransforms.map(function(t){return e.Li(t)});return Ks(!0===n.exists),new zi(a,u)}if(t.verify){var h=this.Z(t.verify);return new Wi(h,n)}return Zs()},js.prototype.Di=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Zs()},js.prototype.Ni=function(t){return void 0!==t.updateTime?Fi.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Fi.exists(t.exists):Fi.dt()},js.prototype.ki=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Mr.min())&&(n=this.fromVersion(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Oi(n,r)},js.prototype.Oi=function(t,e){var n=this;return t&&0<t.length?(Ks(void 0!==e),t.map(function(t){return n.ki(t,e)})):[]},js.prototype.Ci=function(t){var e=t.transform;if(e instanceof Ai)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ni)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof _i)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof Ri)return{fieldPath:t.field.j(),increment:e.ct};throw Zs()},js.prototype.Li=function(t){var e=null;if("setToServerValue"in t)Ks("REQUEST_TIME"===t.setToServerValue),e=Ai.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new Ni(n)}else if("removeAllFromArray"in t){var r=t.removeAllFromArray.values||[];e=new _i(r)}else"increment"in t?e=new Ri(this,t.increment):Zs();var i=Xr.J(t.fieldPath);return new xi(i,e)},js.prototype.qi=function(t){return{documents:[this.Ti(t.path)]}},js.prototype.Mi=function(t){Ks(1===t.documents.length);var e=t.documents[0];return No.Wt(this.Ei(e)).ee()},js.prototype.xi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Ti(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Ti(n.k()),e.structuredQuery.from=[{collectionId:n.q()}]);var r=this.Bi(t.filters);r&&(e.structuredQuery.where=r);var i=this.Ui(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},js.prototype.Wi=function(t){var e=this.Ei(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){Ks(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.ji(n.where));var a=[];n.orderBy&&(a=this.Gi(n.orderBy));var u=null;n.limit&&(u=this.oi(n.limit));var h=null;n.startAt&&(h=this.Hi(n.startAt));var c=null;return n.endAt&&(c=this.Hi(n.endAt)),new No(e,i,a,s,u,"F",h,c).ee()},js.prototype.Ki=function(t){var e=this.zi(t.we);return null==e?null:{"goog-listen-tags":e}},js.prototype.zi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Zs()}},js.prototype.ee=function(t){var e,n=t.target;return(e=n.qt()?{documents:this.qi(n)}:{query:this.xi(n)}).targetId=t.targetId,0<t.resumeToken.rt()&&(e.resumeToken=this.ui(t.resumeToken)),e},js.prototype.Bi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof _o?e.Yi(t):Zs()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},js.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Xi(t)]:void 0!==t.fieldFilter?[this.Ji(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.ji(t)}).reduce(function(t,e){return t.concat(e)}):Zs():[]},js.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.Zi(t)})},js.prototype.Gi=function(t){var e=this;return t.map(function(t){return e.tn(t)})},js.prototype.Qi=function(t){return{before:t.before,values:t.position}},js.prototype.Hi=function(t){var e=!!t.before,n=t.values||[];return new Oo(n,e)},js.prototype.en=function(t){return qs[t]},js.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},js.prototype.nn=function(t){return xs[t]},js.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Zs()}},js.prototype.hn=function(t){return{fieldPath:t.j()}},js.prototype.on=function(t){return Xr.J(t.fieldPath)},js.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},js.prototype.tn=function(t){return new Vo(this.on(t.field),this.sn(t.direction))},js.prototype.Ji=function(t){return _o.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},js.prototype.Yi=function(t){if("=="===t.op){if(Ei(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(bi(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},js.prototype.Xi=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return _o.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return _o.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Zs()}},js.prototype.Si=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.j())}),{fieldPaths:e}},js.prototype.$i=function(t){var e=t.fieldPaths||[];return new qi(e.map(function(t){return Xr.J(t)}))},js);function js(t,e){this.ii=t,this.options=e}function Gs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Bs=(Hs.an=function(t){Hs.platform&&Zs(),Hs.platform=t},Hs.nt=function(){return Hs.platform||Zs(),Hs.platform},Hs),zs=new c("@firebase/firestore");function Hs(){}function Ws(){return zs.logLevel}function Qs(t){zs.logLevel=t}function Xs(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zs.logLevel<=a.DEBUG){var r=e.map(Ys);zs.debug.apply(zs,i(["Firestore ("+Er+"): "+t],r))}}function Js(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zs.logLevel<=a.ERROR){var r=e.map(Ys);zs.error.apply(zs,i(["Firestore ("+Er+"): "+t],r))}}function Ys(t){if("string"==typeof t)return t;var e=Bs.nt();try{return e.un(t)}catch(e){return t}}function Zs(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Er+") INTERNAL ASSERTION FAILED: "+t;throw Js(e),new Error(e)}function Ks(t){t||Zs()}function $s(t){return t}var ta=(ea.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Bs.nt().ln(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},ea);function ea(){}function na(t,e){return t<e?-1:e<t?1:0}function ra(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function ia(t,e,n,r,i){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var oa=(Object.defineProperty(ba.prototype,"_n",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),ba.prototype.isEqual=function(t){return t instanceof ba&&t.projectId===this.projectId&&t.database===this.database},ba.prototype.S=function(t){return na(this.projectId,t.projectId)||na(this.database,t.database)},ba),sa=(wa.prototype.get=function(t){var e=this.fn(t),n=this.dn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(s.isEqual(t))return a}},wa.prototype.has=function(t){return void 0!==this.get(t)},wa.prototype.set=function(t,e){var n=this.fn(t),r=this.dn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.dn[n]=[[t,e]]},wa.prototype.delete=function(t){var e=this.fn(t),n=this.dn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.dn[e]:n.splice(r,1),!0;return!1},wa.prototype.forEach=function(a){$r(this.dn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];a(o,s)}})},wa.prototype.M=function(){return ti(this.dn)},wa),aa=(ma.prototype.at=function(t,e,n){for(var r=n.Tn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var s=r[i];e=o.at(e,s)}}return e},ma.prototype.ot=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.ot(e,e,this.wn))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=u.ot(e,o,this.wn))}return e},ma.prototype.En=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ot(t.key,n.get(t.key));e&&(i=i.Re(t.key,e))}),i},ma.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},vs())},ma.prototype.isEqual=function(t){return this.batchId===t.batchId&&ra(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&ra(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},ma),ua=(ga.from=function(t,e,n,r){Ks(t.mutations.length===n.length);for(var i=ds(),o=t.mutations,s=0;s<o.length;s++)i=i.Re(o[s].key,n[s].version);return new ga(t,e,n,r,i)},ga),ha=(va.prototype.catch=function(t){return this.next(void 0,t)},va.prototype.next=function(r,i){var o=this;return this.Vn&&Zs(),this.Vn=!0,this.Pn?this.error?this.pn(i,this.error):this.yn(r,this.result):new va(function(e,n){o.Rn=function(t){o.yn(r,t).next(e,n)},o.An=function(t){o.pn(i,t).next(e,n)}})},va.prototype.gn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},va.prototype.bn=function(t){try{var e=t();return e instanceof va?e:va.resolve(e)}catch(t){return va.reject(t)}},va.prototype.yn=function(t,e){return t?this.bn(function(){return t(e)}):va.resolve(e)},va.prototype.pn=function(t,e){return t?this.bn(function(){return t(e)}):va.reject(e)},va.resolve=function(n){return new va(function(t,e){t(n)})},va.reject=function(n){return new va(function(t,e){e(n)})},va.vn=function(t){return new va(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},va.Sn=function(t){for(var n=va.resolve(!1),e=function(e){n=n.next(function(t){return t?va.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},va.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.vn(i)},va),ca=(ya.prototype.Nn=function(e,n){var r=this;return this.Dn.$n(e,n).next(function(t){return r.Ln(e,n,t)})},ya.prototype.Ln=function(t,r,i){return this.Cn.kn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ot(r,t);return t})},ya.prototype.On=function(t,e,i){var o=cs();return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ot(t,e);o=o.Re(t,e)}),o},ya.prototype.qn=function(e,t){var n=this;return this.Cn.getEntries(e,t).next(function(t){return n.Mn(e,t)})},ya.prototype.Mn=function(r,i){var o=this;return this.Dn.xn(r,i).next(function(t){var e=o.On(r,i,t),n=hs();return e.forEach(function(t,e){e=e||new Io(t,Mr.min()),n=n.Re(t,e)}),n})},ya.prototype.Bn=function(t,e,n){return e.qt()?this.Un(t,e.path):e.le()?this.Qn(t,e,n):this.Wn(t,e,n)},ya.prototype.Un=function(t,e){return this.Nn(t,new Yr(e)).next(function(t){var e=ls();return t instanceof Eo&&(e=e.Re(t.key,t)),e})},ya.prototype.Qn=function(n,r,i){var o=this,s=r.collectionGroup,a=ls();return this.Fn.jn(n,s).next(function(t){return ha.forEach(t,function(t){var e=r.Zt(t.child(s));return o.Wn(n,e,i).next(function(t){t.forEach(function(t,e){a=a.Re(t,e)})})}).next(function(){return a})})},ya.prototype.Wn=function(e,n,t){var c,f,r=this;return this.Cn.Bn(e,n,t).next(function(t){return c=t,r.Dn.Gn(e,n)}).next(function(t){return f=t,r.Hn(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=c.get(a),h=s.ot(u,u,r.wn);c=h instanceof Eo?c.Re(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},ya.prototype.Hn=function(t,e,n){for(var r=vs(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Bi&&null===n.get(u.key)&&(r=r.add(u.key))}var h=n;return this.Cn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Eo&&(h=h.Re(t,e))}),h})},ya),fa=(da.Yn=function(t,e){for(var n=vs(),r=vs(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new da(t,e.fromCache,n,r)},da),la=(pa.prototype.Jn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},pa.prototype.next=function(){var t=++this.previousValue;return this.Zn&&this.Zn(t),t},pa);function pa(t,e){var n=this;this.previousValue=t,e&&(e.Xn=function(t){return n.Jn(t)},this.Zn=function(t){return e.tr(t)})}function da(t,e,n,r){this.targetId=t,this.fromCache=e,this.Kn=n,this.zn=r}function ya(t,e,n){this.Cn=t,this.Dn=e,this.Fn=n}function va(t){var e=this;this.Rn=null,this.An=null,this.result=void 0,this.error=void 0,this.Pn=!1,this.Vn=!1,t(function(t){e.Pn=!0,e.result=t,e.Rn&&e.Rn(t)},function(t){e.Pn=!0,e.error=t,e.An&&e.An(t)})}function ga(t,e,n,r,i){this.batch=t,this.mn=e,this.Tn=n,this.streamToken=r,this.In=i}function ma(t,e,n,r){this.batchId=t,this.wn=e,this.baseMutations=n,this.mutations=r}function wa(t){this.fn=t,this.dn={}}function ba(t,e){this.projectId=t,this.database=e||"(default)"}la.er=-1;function Ea(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ia=(Da.prototype.reset=function(){this.or=0},Da.prototype.cr=function(){this.or=this.hr},Da.prototype.lr=function(t){var e=this;this.cancel();var n=Math.floor(this.or+this._r()),r=Math.max(0,Date.now()-this.ur),i=Math.max(0,n-r);0<i&&Xs("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.or+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ar=this.sr.dr(this.ir,i,function(){return e.ur=Date.now(),t()}),this.or*=this.rr,this.or<this.nr&&(this.or=this.nr),this.or>this.hr&&(this.or=this.hr)},Da.prototype.cancel=function(){null!==this.ar&&(this.ar.cancel(),this.ar=null)},Da.prototype._r=function(){return(Math.random()-.5)*this.or},Da),Aa=(Sa.prototype.Tr=function(t,e){return this.wr.add(e),ha.resolve()},Sa.prototype.jn=function(t,e){return ha.resolve(this.wr.getEntries(e))},Sa),Ta=(Ra.prototype.add=function(t){var e=t.q(),n=t.k(),r=this.index[e]||new is(Cr.N),i=!r.has(n);return this.index[e]=r.add(n),i},Ra.prototype.has=function(t){var e=t.q(),n=t.k(),r=this.index[e];return r&&r.has(n)},Ra.prototype.getEntries=function(t){return(this.index[t]||new is(Cr.N)).W()},Ra),Na=(_a.prototype.next=function(){return this.Er+=2,this.Er},_a.mr=function(){return new _a(0)},_a.Ir=function(){return new _a(-1)},_a);function _a(t){this.Er=t}function Ra(){this.index={}}function Sa(){this.wr=new Ta}function Da(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.sr=t,this.ir=e,this.nr=n,this.rr=r,this.hr=i,this.or=0,this.ar=null,this.ur=Date.now(),this.reset()}function ka(t){return"IndexedDbTransactionError"===t.name}var La=(Ma.pr=function(t,e,n,r,i){var o=new Ma(t,e,Date.now()+n,r,i);return o.start(n),o},Ma.prototype.start=function(t){var e=this;this.yr=setTimeout(function(){return e.gr()},t)},Ma.prototype.br=function(){return this.gr()},Ma.prototype.cancel=function(t){null!==this.yr&&(this.clearTimeout(),this.Vr.reject(new Sr(Rr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ma.prototype.gr=function(){var e=this;this.Rr.vr(function(){return null!==e.yr?(e.clearTimeout(),e.op().then(function(t){return e.Vr.resolve(t)})):Promise.resolve()})},Ma.prototype.clearTimeout=function(){null!==this.yr&&(this.Pr(this),clearTimeout(this.yr),this.yr=null)},Ma),Oa=(Object.defineProperty(Va.prototype,"Mr",{get:function(){return this.Dr},enumerable:!0,configurable:!0}),Va.prototype.vr=function(t){this.enqueue(t)},Va.prototype.xr=function(t){this.Br(),this.Ur(t)},Va.prototype.Qr=function(t){return this.Br(),this.Ur(t)},Va.prototype.Wr=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Br(),this.Dr?[3,2]:(this.Dr=!0,(e=Bs.nt().window)&&e.removeEventListener("visibilitychange",this.Or),[4,this.Qr(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Va.prototype.enqueue=function(t){return this.Br(),this.Dr?new Promise(function(t){}):this.Ur(t)},Va.prototype.jr=function(i){var t=this;this.Br(),this.Dr||(this.Cr=this.Cr.then(function(){var n=new Ea,r=function(){return d(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,i()];case 1:return t.sent(),n.resolve(),this.kr.reset(),[3,3];case 2:if(!ka(e=t.sent()))throw n.resolve(),e;return Xs("AsyncQueue","Operation failed with retryable error: "+e),this.kr.lr(r),[3,3];case 3:return[2]}})})};return t.vr(r),n.promise}))},Va.prototype.Ur=function(t){var e=this,n=this.Sr.then(function(){return e.$r=!0,t().catch(function(t){throw e.Nr=t,e.$r=!1,Js("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.$r=!1,t})});return this.Sr=n},Va.prototype.dr=function(t,e,n){var r=this;this.Br(),-1<this.Lr.indexOf(t)&&(e=0);var i=La.pr(this,t,e,n,function(t){return r.Gr(t)});return this.Fr.push(i),i},Va.prototype.Br=function(){this.Nr&&Zs()},Va.prototype.Hr=function(){},Va.prototype.Kr=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Sr];case 1:t.sent(),t.label=2;case 2:if(e!==this.Sr)return[3,0];t.label=3;case 3:return[2]}})})},Va.prototype.zr=function(t){for(var e=0,n=this.Fr;e<n.length;e++)if(n[e].ir===t)return!0;return!1},Va.prototype.qr=function(r){var i=this;return this.Kr().then(function(){i.Fr.sort(function(t,e){return t.Ar-e.Ar});for(var t=0,e=i.Fr;t<e.length;t++){var n=e[t];if(n.br(),"all"!==r&&n.ir===r)break}return i.Kr()})},Va.prototype.Yr=function(t){this.Lr.push(t)},Va.prototype.Gr=function(t){var e=this.Fr.indexOf(t);this.Fr.splice(e,1)},Va);function Va(){var t=this;this.Sr=Promise.resolve(),this.Cr=Promise.resolve(),this.Dr=!1,this.Fr=[],this.Nr=null,this.$r=!1,this.Lr=[],this.kr=new Ia(this,"async_queue_retry"),this.Or=function(){t.qr("async_queue_retry")};var e=Bs.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Or)}function Ma(t,e,n,r,i){this.Rr=t,this.ir=e,this.Ar=n,this.op=r,this.Pr=i,this.Vr=new Ea,this.then=this.Vr.promise.then.bind(this.Vr.promise),this.catch=this.Vr.promise.catch.bind(this.Vr.promise),this.Vr.promise.catch(function(t){})}function Pa(t,e){if(Js("AsyncQueue",e+": "+t),ka(t))return new Sr(Rr.UNAVAILABLE,e+": "+t);throw t}var Ca=(Ua.th=function(t){return new Ua(t,Ua.eh,Ua.sh)},Ua);function Ua(t,e,n){this.Xr=t,this.Jr=e,this.Zr=n}Ca.ih=-1,Ca.nh=1048576,Ca.rh=41943040,Ca.eh=10,Ca.sh=1e3,Ca.hh=new Ca(Ca.rh,Ca.eh,Ca.sh),Ca.DISABLED=new Ca(Ca.ih,0,0);var qa=(xa.prototype.start=function(){return Promise.resolve()},xa.prototype.Rh=function(i){return d(this,void 0,void 0,function(){var e,m,n,r=this;return y(this,function(t){switch(t.label){case 0:return e=this.Dn,m=this.Eh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Dn.Ah(v).next(function(t){return g=t,e=r.persistence._h(i),m=new ca(r.fh,e,r.persistence.mh()),e.Ah(v)}).next(function(t){for(var e=[],n=[],r=vs(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++){var h=u[a];r=r.add(h.key)}}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.qn(v,r).next(function(t){return{Ph:t,Vh:e,ph:n}})})})];case 1:return n=t.sent(),[2,(this.Dn=e,this.Eh=m,this.oh.Ih(this.Eh),n)]}})})},xa.prototype.yh=function(a){var u,h=this,c=Vr.now(),t=a.reduce(function(t,e){return t.add(e.key)},vs());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Eh.qn(s,t).next(function(t){u=t;for(var e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=i.Pt(u.get(i.key));null!=o&&e.push(new Bi(i.key,o,so(o.proto.mapValue),Fi.exists(!0)))}return h.Dn.gh(s,c,e,a)})}).then(function(t){var e=t.En(u);return{batchId:t.batchId,bh:e}})},xa.prototype.vh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.fh.Sh({Ch:!0});return i.Dn.vh(t,r.batch,r.streamToken).next(function(){return i.Dh(t,r,n)}).next(function(){return n.apply(t)}).next(function(){return i.Dn.Fh(t)}).next(function(){return i.Eh.qn(t,e)})})},xa.prototype.Nh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Dn.$h(e,t).next(function(t){return Ks(null!==t),n=t.keys(),r.Dn.Lh(e,t)}).next(function(){return r.Dn.Fh(e)}).next(function(){return r.Eh.qn(e,n)})})},xa.prototype.kh=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Dn.kh(t)})},xa.prototype.Oh=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.Dn.Oh(t)})},xa.prototype.qh=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.Dn.qh(t,e)})},xa.prototype.Mh=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.wh.Mh(t)})},xa.prototype.xh=function(u){var h=this,c=u.Te,f=this.ah;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.fh.Sh({Ch:!0});f=h.ah;var s=[];u.as.forEach(function(t,e){var n=f.get(e);if(n){s.push(h.wh.Bh(o,t.Es,e).next(function(){return h.wh.Uh(o,t.ws,e)}));var r=t.resumeToken;if(0<r.rt()){var i=n.me(r,c).Ee(o.Qh);f=f.Re(e,i),xa.Wh(n,i,t)&&s.push(h.wh.jh(o,i))}}});var a=hs(),n=vs();if(u.cs.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){u.cs.forEach(function(t,e){var n=r.get(t);e instanceof Io&&e.version.isEqual(Mr.min())?(i.Gh(t,c),a=a.Re(t,e)):null==n||0<e.version.S(n.version)||0===e.version.S(n.version)&&n.hasPendingWrites?(i.Hh(e,c),a=a.Re(t,e)):Xs("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.ls.has(t)&&s.push(h.persistence.zh.Kh(o,t))})})),!c.isEqual(Mr.min())){var t=h.wh.Mh(o).next(function(t){return h.wh.Yh(o,o.Qh,c)});s.push(t)}return ha.vn(s).next(function(){return i.apply(o)}).next(function(){return h.Eh.Mn(o,a)})}).then(function(t){return h.ah=f,t})},xa.Wh=function(t,e,n){return Ks(0<e.resumeToken.rt()),0===t.resumeToken.rt()||e.Te.C()-t.Te.C()>=this.Xh||0<n.ws.size+n.Ts.size+n.Es.size},xa.prototype.Jh=function(c){return d(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,h=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ha.forEach(c,function(e){return ha.forEach(e.Kn,function(t){return h.persistence.zh.Zh(n,e.targetId,t)}).next(function(){return ha.forEach(e.zn,function(t){return h.persistence.zh.to(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!ka(e=t.sent()))throw e;return Xs("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.ah.get(o),a=s.Te,u=s.Ie(a),this.ah=this.ah.Re(o,u));return[2]}})})},xa.prototype.eo=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Dn.so(t,e)})},xa.prototype.io=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Eh.Nn(t,e)})},xa.prototype.no=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.wh.ro(e,r).next(function(t){return t?(n=t,ha.resolve(n)):i.wh.ho(e).next(function(t){return n=new Mo(r,t,0,e.Qh),i.wh.oo(e,n).next(function(){return n})})})}).then(function(t){return null===i.ah.get(t.targetId)&&(i.ah=i.ah.Re(t.targetId,t),i.uh.set(r,t.targetId)),t})},xa.prototype.ro=function(t,e){var n=this.uh.get(e);return void 0!==n?ha.resolve(this.ah.get(n)):this.wh.ro(t,e)},xa.prototype.ao=function(t,e){var n=this,r=this.ah.get(t),i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,function(t){return e?ha.resolve():n.persistence.zh.removeTarget(t,r)}).then(function(){n.ah=n.ah.remove(t),n.uh.delete(r.target)})},xa.prototype.uo=function(t,n){var r=this,i=Mr.min(),o=vs();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.ro(e,t.ee()).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.wh.co(e,t.targetId).next(function(t){o=t})}).next(function(){return r.oh.Bn(e,t,n?i:Mr.min(),n?o:vs())}).next(function(t){return{documents:t,lo:o}})})},xa.prototype.Dh=function(t,i,o){var e=this,s=i.batch,n=s.keys(),a=ha.resolve();return n.forEach(function(r){a=a.next(function(){return o.kn(t,r)}).next(function(t){var e=t,n=i.In.get(r);Ks(null!==n),(!e||e.version.S(n)<0)&&(e=s.at(r,e,i))&&o.Hh(e,i.mn)})}),a.next(function(){return e.Dn.Lh(t,s)})},xa.prototype._o=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.fo(t,n.ah)})},xa);function xa(t,e,n){this.persistence=t,this.oh=e,this.ah=new Zo(na),this.uh=new sa(function(t){return t.canonicalId()}),this.lh=Mr.min(),this.Dn=t._h(n),this.fh=t.dh(),this.wh=t.Th(),this.Eh=new ca(this.fh,this.Dn,this.persistence.mh()),this.oh.Ih(this.Eh)}function Fa(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Rr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Xs("LocalStore","Unexpectedly lost primary lease"),[2]})})}qa.Xh=3e8;var ja=(za.prototype.M=function(){return this.do.M()},za.prototype.Zh=function(t,e){var n=new Ga(t,e);this.do=this.do.add(n),this.To=this.To.add(n)},za.prototype.mo=function(t,e){var n=this;t.forEach(function(t){return n.Zh(t,e)})},za.prototype.to=function(t,e){this.Io(new Ga(t,e))},za.prototype.Ro=function(t,e){var n=this;t.forEach(function(t){return n.to(t,e)})},za.prototype.Ao=function(t){var e=this,n=Yr.EMPTY,r=new Ga(n,t),i=new Ga(n,t+1),o=[];return this.To.Ge([r,i],function(t){e.Io(t),o.push(t.key)}),o},za.prototype.Po=function(){var e=this;this.do.forEach(function(t){return e.Io(t)})},za.prototype.Io=function(t){this.do=this.do.delete(t),this.To=this.To.delete(t)},za.prototype.Vo=function(t){var e=Yr.EMPTY,n=new Ga(e,t),r=new Ga(e,t+1),i=vs();return this.To.Ge([n,r],function(t){i=i.add(t.key)}),i},za.prototype.po=function(t){var e=new Ga(t,0),n=this.do.Ke(e);return null!==n&&t.isEqual(n.key)},za),Ga=(Ba.wo=function(t,e){return Yr.N(t.key,e.key)||na(t.yo,e.yo)},Ba.Eo=function(t,e){return na(t.yo,e.yo)||Yr.N(t.key,e.key)},Ba);function Ba(t,e){this.key=t,this.yo=e}function za(){this.do=new is(Ga.wo),this.To=new is(Ga.Eo)}function Ha(t,e){if(0!==e.length)throw new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+uu(e.length,"argument")+".")}function Wa(t,e,n){if(e.length!==n)throw new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() requires "+uu(n,"argument")+", but was called with "+uu(e.length,"argument")+".")}function Qa(t,e,n){if(e.length<n)throw new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+uu(n,"argument")+", but was called with "+uu(e.length,"argument")+".")}function Xa(t,e,n,r){if(e.length<n||e.length>r)throw new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+uu(e.length,"argument")+".")}function Ja(t,e,n,r){tu(t,e,au(n)+" argument",r)}function Ya(t,e,n,r){void 0!==r&&Ja(t,e,n,r)}function Za(t,e,n,r){tu(t,e,n+" option",r)}function Ka(t,e,n,r){void 0!==r&&Za(t,e,n,r)}function $a(t,e,n,r,u){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=u;i<o.length;i++){var s=o[i];if(s===n)return;r.push(nu(s))}var a=nu(n);throw new Sr(Rr.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function tu(t,e,n,r){if(!("object"===e?eu(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=nu(r);throw new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function eu(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function nu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Zs();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ru(t,e,n){if(void 0===n)throw new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+au(e)+" argument, but it was undefined.")}function iu(n,t,r){$r(t,function(t,e){if(r.indexOf(t)<0)throw new Sr(Rr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ou(t,e,n,r){var i=nu(r);return new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() requires its "+au(n)+" argument to be a "+e+", but it was: "+i)}function su(t,e,n){if(n<=0)throw new Sr(Rr.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+au(e)+" argument to be a positive number, but it was: "+n+".")}function au(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function uu(t,e){return t+" "+e+(1===t?"":"s")}function hu(){if("undefined"==typeof Uint8Array)throw new Sr(Rr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function cu(){if(!Bs.nt().bo)throw new Sr(Rr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var fu=(du.fromBase64String=function(t){Wa("Blob.fromBase64String",arguments,1),Ja("Blob.fromBase64String","string",1,t),cu();try{return new du(ei.fromBase64String(t))}catch(t){throw new Sr(Rr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},du.fromUint8Array=function(t){if(Wa("Blob.fromUint8Array",arguments,1),hu(),!(t instanceof Uint8Array))throw ou("Blob.fromUint8Array","Uint8Array",1,t);return new du(ei.fromUint8Array(t))},du.prototype.toBase64=function(){return Wa("Blob.toBase64",arguments,0),cu(),this.vo.toBase64()},du.prototype.toUint8Array=function(){return Wa("Blob.toUint8Array",arguments,0),hu(),this.vo.toUint8Array()},du.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},du.prototype.isEqual=function(t){return this.vo.isEqual(t.vo)},du),lu=(pu.documentId=function(){return pu.Co},pu.prototype.isEqual=function(t){if(!(t instanceof pu))throw ou("isEqual","FieldPath",1,t);return this.So.isEqual(t.So)},pu);function pu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new Sr(Rr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(Ja("FieldPath","string",n,t[n]),0===t[n].length)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.So=new Xr(t)}function du(t){cu(),this.vo=t}lu.Co=new lu(Xr.X().j());var yu,vu,gu,mu,wu,bu=new RegExp("[~\\*/\\[\\]]"),Eu=function(t){this.Do=t},Iu=(n(qu,wu=Eu),qu.prototype.Ci=function(t){if(2!==t.Fo)throw 1===t.Fo?t.No("FieldValue.delete() can only appear at the top level of your update data"):t.No("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},qu.prototype.isEqual=function(t){return t instanceof qu},qu),Au=(n(Uu,mu=Eu),Uu.prototype.Ci=function(t){return new xi(t.path,Ai.instance)},Uu.prototype.isEqual=function(t){return t instanceof Uu},Uu),Tu=(n(Cu,gu=Eu),Cu.prototype.Ci=function(t){var e=new Fu({Fo:3,methodName:this.Do,Lo:!0},t.ii,t.serializer),n=this.$o.map(function(t){return zu(t,e)}),r=new Ni(n);return new xi(t.path,r)},Cu.prototype.isEqual=function(t){return this===t},Cu),Nu=(n(Pu,vu=Eu),Pu.prototype.Ci=function(t){var e=new Fu({Fo:3,methodName:this.Do,Lo:!0},t.ii,t.serializer),n=this.$o.map(function(t){return zu(t,e)}),r=new _i(n);return new xi(t.path,r)},Pu.prototype.isEqual=function(t){return this===t},Pu),_u=(n(Mu,yu=Eu),Mu.prototype.Ci=function(t){var e=new Fu({Fo:3,methodName:this.Do},t.ii,t.serializer),n=zu(this.ko,e),r=new Ri(t.serializer,n);return new xi(t.path,r)},Mu.prototype.isEqual=function(t){return this===t},Mu),Ru=(Object.defineProperty(Vu.prototype,"latitude",{get:function(){return this.Oo},enumerable:!0,configurable:!0}),Object.defineProperty(Vu.prototype,"longitude",{get:function(){return this.qo},enumerable:!0,configurable:!0}),Vu.prototype.isEqual=function(t){return this.Oo===t.Oo&&this.qo===t.qo},Vu.prototype.g=function(t){return na(this.Oo,t.Oo)||na(this.qo,t.qo)},Vu),Su=/^__.*__$/,Du=(Ou.prototype.Mo=function(t,e){var n=[];return null!==this.Vt?n.push(new Bi(t,this.data,this.Vt,e)):n.push(new Gi(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new zi(t,this.fieldTransforms)),n},Ou),ku=(Lu.prototype.Mo=function(t,e){var n=[new Bi(t,this.data,this.Vt,e)];return 0<this.fieldTransforms.length&&n.push(new zi(t,this.fieldTransforms)),n},Lu);function Lu(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function Ou(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function Vu(t,e){if(Wa("GeoPoint",arguments,2),Ja("GeoPoint","number",1,t),Ja("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Sr(Rr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Sr(Rr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Oo=t,this.qo=e}function Mu(t){var e=this;return(e=yu.call(this,"FieldValue.increment")||this).ko=t,e}function Pu(t){var e=this;return(e=vu.call(this,"FieldValue.arrayRemove")||this).$o=t,e}function Cu(t){var e=this;return(e=gu.call(this,"FieldValue.arrayUnion")||this).$o=t,e}function Uu(){return mu.call(this,"FieldValue.serverTimestamp")||this}function qu(){return wu.call(this,"FieldValue.delete")||this}function xu(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Zs()}}var Fu=(Object.defineProperty(Bu.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(Bu.prototype,"Fo",{get:function(){return this.settings.Fo},enumerable:!0,configurable:!0}),Bu.prototype.Bo=function(t){return new Bu(Object.assign(Object.assign({},this.settings),t),this.ii,this.serializer,this.fieldTransforms,this.Vt)},Bu.prototype.Uo=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Bo({path:n,Lo:!1});return r.Qo(t),r},Bu.prototype.Wo=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Bo({path:n,Lo:!1});return r.xo(),r},Bu.prototype.jo=function(t){return this.Bo({path:void 0,Lo:!0})},Bu.prototype.No=function(t){var e=!this.path||this.path.M()?"":" (found in field "+this.path.toString()+")";return new Sr(Rr.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},Bu.prototype.contains=function(e){return void 0!==this.Vt.find(function(t){return e.B(t)})||void 0!==this.fieldTransforms.find(function(t){return e.B(t.field)})},Bu.prototype.xo=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Qo(this.path.get(t))},Bu.prototype.Qo=function(t){if(0===t.length)throw this.No("Document fields must not be empty");if(xu(this.Fo)&&Su.test(t))throw this.No('Document fields cannot begin and end with "__"')},Bu),ju=(Gu.prototype.Ho=function(t,e){var n=this.Ko(0,t);Qu("Data must be an object, but it was:",n,e);var r=Hu(e,n);return new Du(new Qi(r),null,n.fieldTransforms)},Gu.prototype.zo=function(t,e,n){var r=this.Ko(2,t);Qu("Data must be an object, but it was:",r,e);var i,o,s=Hu(e,r);if(n){for(var a=[],u=0,h=n;u<h.length;u++){var c=h[u],f=void 0;if(c instanceof lu)f=c.So;else{if("string"!=typeof c)throw Zs();f=Ju(t,c)}if(!r.contains(f))throw new Sr(Rr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Yu(a,f)||a.push(f)}i=new qi(a),o=r.fieldTransforms.filter(function(t){return i.ft(t.field)})}else i=new qi(r.Vt),o=r.fieldTransforms;return new Du(new Qi(s),i,o)},Gu.prototype.Yo=function(o,t){var s=this.Ko(1,o);Qu("Data must be an object, but it was:",s,t);var a=[],u=new Xi;$r(t,function(t,e){var n=Ju(o,t),r=s.Wo(n);if(e instanceof Iu)a.push(n);else{var i=zu(e,r);null!=i&&(a.push(n),u.set(n,i))}});var e=new qi(a);return new ku(u.gt(),e,s.fieldTransforms)},Gu.prototype.Xo=function(t,e,n,r){var i=this.Ko(1,t),o=[Xu(t,e)],s=[n];if(r.length%2!=0)throw new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var a=0;a<r.length;a+=2)o.push(Xu(t,r[a])),s.push(r[a+1]);for(var u=[],h=new Xi,c=o.length-1;0<=c;--c)if(!Yu(u,o[c])){var f=o[c],l=s[c],p=i.Wo(f);if(l instanceof Iu)u.push(f);else{var d=zu(l,p);null!=d&&(u.push(f),h.set(f,d))}}var y=new qi(u);return new ku(h.gt(),y,i.fieldTransforms)},Gu.prototype.Ko=function(t,e){return new Fu({Fo:t,methodName:e,path:Xr.H,Lo:!1},this.ii,this.serializer)},Gu.prototype.Jo=function(t,e,n){return void 0===n&&(n=!1),zu(e,this.Ko(n?4:3,t))},Gu);function Gu(t,e){this.ii=t,this.serializer=e||Bs.nt().Go(t)}function Bu(t,e,n,r,i){this.settings=t,this.ii=e,this.serializer=n,void 0===r&&this.xo(),this.fieldTransforms=r||[],this.Vt=i||[]}function zu(s,t){if(Wu(s))return Qu("Unsupported field value:",t,s),Hu(s,t);if(s instanceof Eu)return function(t,e){if(!xu(e.Fo))throw e.No(t.Do+"() can only be used with update() and set()");if(null===e.path)throw e.No(t.Do+"() is not currently supported inside arrays");var n=t.Ci(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Vt.push(t.path),s instanceof Array){if(t.settings.Lo&&4!==t.Fo)throw t.No("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=zu(i[r],t.jo(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Vr.fromDate(t);return{timestampValue:e.serializer.D(n)}}if(t instanceof Vr){var r=new Vr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.D(r)}}if(t instanceof Ru)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof fu)return{bytesValue:e.serializer.ui(t)};if(t instanceof pc){var i=e.ii,o=t.firestore.Zo;if(!o.isEqual(i))throw e.No("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:e.serializer.li(t.ta.path,t.firestore.Zo)}}throw e.No("Unsupported field value: "+nu(t))}(s,t)}function Hu(t,r){var i={};return ti(t)?r.path&&0<r.path.length&&r.Vt.push(r.path):$r(t,function(t,e){var n=zu(e,r.Uo(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Wu(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Vr||t instanceof Ru||t instanceof fu||t instanceof pc||t instanceof Eu)}function Qu(t,e,n){if(!Wu(n)||!eu(n)){var r=nu(n);throw"an object"===r?e.No(t+" a custom object"):e.No(t+" "+r)}}function Xu(t,e){if(e instanceof lu)return e.So;if("string"==typeof e)return Ju(t,e);throw new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Ju(t,e){try{return function(e){if(0<=e.search(bu))throw new Sr(Rr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(lu.bind.apply(lu,i([void 0],e.split("."))))}catch(t){throw new Sr(Rr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).So}catch(e){var n=e instanceof Error?e.message:e.toString();throw new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Yu(t,e){return t.some(function(t){return t.isEqual(e)})}function Zu(t){this.key=t}function Ku(t){this.key=t}function $u(t,e,n){this.query=t,this.targetId=e,this.view=n}function th(t){this.key=t,this.vc=!1}function eh(){this.rl=void 0,this.hl=[]}var nh,rh,ih,oh,sh=(xh.prototype.ha=function(){return 1===this.state||2===this.state||4===this.state},xh.prototype.oa=function(){return 2===this.state},xh.prototype.start=function(){3!==this.state?this.auth():this.aa()},xh.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ha()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},xh.prototype.ua=function(){this.state=0,this.kr.reset()},xh.prototype.ca=function(){var t=this;this.oa()&&null===this.ra&&(this.ra=this.sr.dr(this.ea,6e4,function(){return t.la()}))},xh.prototype._a=function(t){this.fa(),this.stream.send(t)},xh.prototype.la=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.oa()?[2,this.close(0)]:[2]})})},xh.prototype.fa=function(){this.ra&&(this.ra.cancel(),this.ra=null)},xh.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.fa(),this.kr.cancel(),this.na++,3!==e?this.kr.reset():n&&n.code===Rr.RESOURCE_EXHAUSTED?(Js(n.toString()),Js("Using maximum backoff delay to prevent overloading the backend."),this.kr.cr()):n&&n.code===Rr.UNAUTHENTICATED&&this.ia.l(),null!==this.stream&&(this.da(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.wa(n)];case 1:return t.sent(),[2]}})})},xh.prototype.da=function(){},xh.prototype.auth=function(){var n=this;this.state=1;var t=this.Ta(this.na),e=this.na;this.ia.getToken().then(function(t){n.na===e&&n.Ea(t)},function(e){t(function(){var t=new Sr(Rr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ma(t)})})},xh.prototype.Ea=function(t){var e=this,n=this.Ta(this.na);this.stream=this.Ia(t),this.stream.Ra(function(){n(function(){return e.state=2,e.listener.Ra()})}),this.stream.wa(function(t){n(function(){return e.ma(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},xh.prototype.aa=function(){var t=this;this.state=4,this.kr.lr(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},xh.prototype.ma=function(t){return Xs("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},xh.prototype.Ta=function(e){var n=this;return function(t){n.sr.vr(function(){return n.na===e?t():(Xs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},xh),ah=(n(qh,ih=sh),qh.prototype.Ia=function(t){return this.sa.Aa("Listen",t)},qh.prototype.onMessage=function(t){this.kr.reset();var e=this.serializer.yi(t),n=this.serializer.bi(t);return this.listener.Pa(e,n)},qh.prototype.Va=function(t){var e={};e.database=this.serializer.mi,e.addTarget=this.serializer.ee(t);var n=this.serializer.Ki(t);n&&(e.labels=n),this._a(e)},qh.prototype.pa=function(t){var e={};e.database=this.serializer.mi,e.removeTarget=t,this._a(e)},qh),uh=(n(Uh,rh=sh),Object.defineProperty(Uh.prototype,"ga",{get:function(){return this.ya},enumerable:!0,configurable:!0}),Uh.prototype.start=function(){this.ya=!1,rh.prototype.start.call(this)},Uh.prototype.da=function(){this.ya&&this.ba([])},Uh.prototype.Ia=function(t){return this.sa.Aa("Write",t)},Uh.prototype.onMessage=function(t){if(Ks(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.ya){this.kr.reset();var e=this.serializer.Oi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.va(n,e)}return Ks(!t.writeResults||0===t.writeResults.length),this.ya=!0,this.listener.Sa()},Uh.prototype.Ca=function(){var t={};t.database=this.serializer.mi,this._a(t)},Uh.prototype.ba=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map(function(t){return e.serializer.vi(t)})};this._a(n)},Uh),hh=(n(Ch,nh=function(){this.Da=void 0}),Ch.prototype.Fa=function(e,n){var r=this;return this.credentials.getToken().then(function(t){return r.sa.Fa(e,n,t)}).catch(function(t){throw t.code===Rr.UNAUTHENTICATED&&r.credentials.l(),t})},Ch.prototype.Na=function(e,n){var r=this;return this.credentials.getToken().then(function(t){return r.sa.Na(e,n,t)}).catch(function(t){throw t.code===Rr.UNAUTHENTICATED&&r.credentials.l(),t})},Ch),ch=(Ph.prototype.Ma=function(r){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.xa(),0<this.mutations.length)throw new Sr(Rr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,a){return d(this,void 0,void 0,function(){var n,e,r,i,o;return y(this,function(t){switch(t.label){case 0:return n=$s(s),e={database:n.serializer.mi,documents:a.map(function(t){return n.serializer.di(t)})},[4,n.Na("BatchGetDocuments",e)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e=n.serializer.pi(t);i.set(e.key.toString(),e)}),o=[],[2,(a.forEach(function(t){var e=i.get(t.toString());Ks(!!e),o.push(e)}),o)]}})})}(this.$a,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Io||t instanceof Eo?n.Ba(t):Zs()}),e)]}})})},Ph.prototype.set=function(t,e){this.write(e.Mo(t,this.Rt(t))),this.qa.add(t)},Ph.prototype.update=function(t,e){try{this.write(e.Mo(t,this.Ua(t)))}catch(t){this.Oa=t}this.qa.add(t)},Ph.prototype.delete=function(t){this.write([new Hi(t,this.Rt(t))]),this.qa.add(t)},Ph.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.xa(),this.Oa)throw this.Oa;return e=this.La,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new Wi(t,n.Rt(t)))}),[4,function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return e=$s(i),n={database:e.serializer.mi,writes:o.map(function(t){return e.serializer.vi(t)})},[4,e.Fa("Commit",n)];case 1:return r=t.sent(),[2,e.serializer.Oi(r.writeResults,r.commitTime)]}})})}(this.$a,this.mutations)];case 1:return t.sent(),this.ka=!0,[2]}})})},Ph.prototype.Ba=function(t){var e;if(t instanceof Eo)e=t.version;else{if(!(t instanceof Io))throw Zs();e=Mr.min()}var n=this.La.get(t.key);if(null!==n){if(!e.isEqual(n))throw new Sr(Rr.ABORTED,"Document version changed between two reads.")}else this.La=this.La.Re(t.key,e)},Ph.prototype.Rt=function(t){var e=this.La.get(t);return!this.qa.has(t)&&e?Fi.updateTime(e):Fi.dt()},Ph.prototype.Ua=function(t){var e=this.La.get(t);if(this.qa.has(t)||!e)return Fi.exists(!0);if(e.isEqual(Mr.min()))throw new Sr(Rr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fi.updateTime(e)},Ph.prototype.write=function(t){this.xa(),this.mutations=this.mutations.concat(t)},Ph.prototype.xa=function(){},Ph),fh=(Mh.prototype.Ha=function(){var t=this;0===this.Wa&&(this.Ka("Unknown"),this.ja=this.Rr.dr("online_state_timeout",1e4,function(){return t.ja=null,t.za("Backend didn't respond within 10 seconds."),t.Ka("Offline"),Promise.resolve()}))},Mh.prototype.Ya=function(t){"Online"===this.state?this.Ka("Unknown"):(this.Wa++,1<=this.Wa&&(this.Xa(),this.za("Connection failed 1 times. Most recent error: "+t.toString()),this.Ka("Offline")))},Mh.prototype.set=function(t){this.Xa(),this.Wa=0,"Online"===t&&(this.Ga=!1),this.Ka(t)},Mh.prototype.Ka=function(t){t!==this.state&&(this.state=t,this.Qa(t))},Mh.prototype.za=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ga?(Js(e),this.Ga=!1):Xs("OnlineStateTracker",e)},Mh.prototype.Xa=function(){null!==this.ja&&(this.ja.cancel(),this.ja=null)},Mh),lh=(Vh.prototype.start=function(){return this.enableNetwork()},Vh.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.Tu()},Vh.prototype.Tu=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.ru()?(e=this._u,[4,this.Ja.Oh()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.Eu()?this.mu():this.ou.set("Unknown"),[4,this.Iu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Vh.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Ru()];case 1:return t.sent(),this.ou.set("Offline"),[2]}})})},Vh.prototype.Ru=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this._u.stop()];case 1:return t.sent(),[4,this.au.stop()];case 2:return t.sent(),0<this.Za.length&&(Xs("RemoteStore","Stopping write stream with "+this.Za.length+" pending writes"),this.Za=[]),this.Au(),[2]}})})},Vh.prototype.Pu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Xs("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Ru()];case 1:return t.sent(),this.iu.Pu(),this.ou.set("Unknown"),[2]}})})},Vh.prototype.listen=function(t){this.tu.has(t.targetId)||(this.tu.set(t.targetId,t),this.Eu()?this.mu():this.au.oa()&&this.Vu(t))},Vh.prototype.pu=function(t){this.tu.delete(t),this.au.oa()&&this.yu(t),0===this.tu.size&&(this.au.oa()?this.au.ca():this.ru()&&this.ou.set("Unknown"))},Vh.prototype.si=function(t){return this.tu.get(t)||null},Vh.prototype.ei=function(t){return this.gu.ei(t)},Vh.prototype.Vu=function(t){this.eu.Ns(t.targetId),this.au.Va(t)},Vh.prototype.yu=function(t){this.eu.Ns(t),this.au.pa(t)},Vh.prototype.mu=function(){this.eu=new Ss(this),this.au.start(),this.ou.Ha()},Vh.prototype.Eu=function(){return this.ru()&&!this.au.ha()&&0<this.tu.size},Vh.prototype.ru=function(){return!this.su&&this.isPrimary&&this.networkEnabled},Vh.prototype.Au=function(){this.eu=null},Vh.prototype.uu=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.tu.forEach(function(t,e){n.Vu(t)}),[2]})})},Vh.prototype.cu=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Au(),this.Eu()?(this.ou.Ya(e),this.mu()):this.ou.set("Unknown"),[2]})})},Vh.prototype.lu=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:if(this.ou.set("Online"),!(i instanceof Es&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.bu(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Xs("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.vu(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof ws?this.eu.Bs(i):i instanceof bs?this.eu.zs(i):this.eu.Ws(i),o.isEqual(Mr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.Ja.Mh()];case 8:return n=t.sent(),0<=o.S(n)?[4,this.Su(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Xs("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.vu(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Vh.prototype.vu=function(n){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!ka(n))throw n;return this.su=!0,[4,this.Ru()];case 1:return t.sent(),this.ou.set("Offline"),this.Rr.jr(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Xs("RemoteStore","Retrying IndexedDB access"),[4,this.Ja.Mh()];case 1:return t.sent(),this.su=!1,[4,this.Tu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Vh.prototype.Su=function(r){var i=this,t=this.eu.Js(r);return t.as.forEach(function(t,e){if(0<t.resumeToken.rt()){var n=i.tu.get(e);n&&i.tu.set(e,n.me(t.resumeToken,r))}}),t.us.forEach(function(t){var e=i.tu.get(t);if(e){i.tu.set(t,e.me(ei.ht,e.Te)),i.yu(t);var n=new Mo(e.target,t,1,e.sequenceNumber);i.Vu(n)}}),this.gu.xh(t)},Vh.prototype.bu=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.tu.has(i)?[4,this.gu.Cu(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.tu.delete(i),this.eu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Vh.prototype.Iu=function(){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.Du()?(e=0<this.Za.length?this.Za[this.Za.length-1].batchId:-1,[4,this.Ja.eo(e)]):[3,5];case 1:return null!==(n=t.sent())?[3,2]:(0===this.Za.length&&this._u.ca(),[3,4]);case 2:return this.Fu(n),[4,this.Iu()];case 3:t.sent(),t.label=4;case 4:t.label=5;case 5:return this.Nu()&&this.$u(),[2]}})})},Vh.prototype.Du=function(){return this.ru()&&this.Za.length<10},Vh.prototype.Lu=function(){return this.Za.length},Vh.prototype.Fu=function(t){this.Za.push(t),this._u.oa()&&this._u.ga&&this._u.ba(t.mutations)},Vh.prototype.Nu=function(){return this.ru()&&!this._u.ha()&&0<this.Za.length},Vh.prototype.$u=function(){this._u.start()},Vh.prototype.fu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this._u.Ca(),[2]})})},Vh.prototype.wu=function(){var r=this;return this.Ja.qh(this._u.lastStreamToken).then(function(){for(var t=0,e=r.Za;t<e.length;t++){var n=e[t];r._u.ba(n.mutations)}}).catch(Fa)},Vh.prototype.va=function(t,e){var n=this,r=this.Za.shift(),i=ua.from(r,t,e,this._u.lastStreamToken);return this.gu.ku(i).then(function(){return n.Iu()})},Vh.prototype.du=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&0<this.Za.length?this._u.ga?[4,this.Ou(e)]:[3,2]:[3,5];case 1:return t.sent(),[3,4];case 2:return[4,this.qu(e)];case 3:t.sent(),t.label=4;case 4:this.Nu()&&this.$u(),t.label=5;case 5:return[2]}})})},Vh.prototype.qu=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return Jo(e.code)?[2,(Xs("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this._u.lastStreamToken),this._u.lastStreamToken=ei.ht,this.Ja.qh(ei.ht).catch(Fa))]:[2]})})},Vh.prototype.Ou=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return Jo(n=i.code)&&n!==Rr.ABORTED?(e=this.Za.shift(),[2,(this._u.ua(),this.gu.Mu(e.batchId,i).then(function(){return r.Iu()}))]):[2]})})},Vh.prototype.xu=function(){return new ch(this.$a)},Vh.prototype.hu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Ru()];case 1:return t.sent(),this.ou.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Vh.prototype.Bu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ru()?(Xs("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.hu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Vh.prototype.Uu=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Ru()];case 3:t.sent(),this.ou.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Vh),ph=(Oh.prototype.Qu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Oh.prototype.Wu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Oh.prototype.ju=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},Oh),dh=(Lh.prototype.Ku=function(t){},Lh.prototype.zu=function(t,e,n){},Lh.prototype.Yu=function(t){return this.Gu.Qu(t),this.Hu[t]||"not-current"},Lh.prototype.Xu=function(t,e,n){this.Hu[t]=e},Lh.prototype.Ju=function(t){this.Gu.Wu(t)},Lh.prototype.Zu=function(t){return this.Gu.activeTargetIds.has(t)},Lh.prototype.tc=function(t){delete this.Hu[t]},Lh.prototype.ec=function(){return this.Gu.activeTargetIds},Lh.prototype.sc=function(t){return this.Gu.activeTargetIds.has(t)},Lh.prototype.start=function(){return this.Gu=new ph,Promise.resolve()},Lh.prototype.Rh=function(t,e,n){},Lh.prototype.ic=function(t){},Lh.prototype.Pu=function(){},Lh.prototype.tr=function(t){},Lh),yh=(Object.defineProperty(kh.prototype,"ac",{get:function(){return this.nc},enumerable:!0,configurable:!0}),kh.prototype.uc=function(t,e){var a=this,u=e?e.cc:new As,h=e?e.oc:this.oc,c=e?e.ns:this.ns,f=h,l=!1,p=this.query.oe()&&h.size===this.query.limit?h.last():null,d=this.query.ae()&&h.size===this.query.limit?h.first():null;if(t.ye(function(t,e){var n=h.get(t),r=e instanceof Eo?e:null;r=r&&(a.query.matches(r)?r:null);var i=!!n&&a.ns.has(n.key),o=!!r&&(r.At||a.ns.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),s=!0):a.lc(n,r)||(u.track({type:2,doc:r}),s=!0,(p&&0<a.query.se(r,p)||d&&a.query.se(r,d)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),s=!0):n&&!r&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.oe()||this.query.ae())for(;f.size>this.query.limit;){var n=this.query.oe()?f.last():f.first();f=f.delete(n.key),c=c.delete(n.key),u.track({type:1,doc:n})}return{oc:f,cc:u,_c:l,ns:c}},kh.prototype.lc=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},kh.prototype.fc=function(t,e,n){var o=this,r=this.oc;this.oc=t.oc,this.ns=t.ns;var i=t.cc.es();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.query.se(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Zs()}}var r,i}),this.dc(n);var s=e?this.wc():[],a=0===this.hc.size&&this.ds?1:0,u=a!==this.rc;return this.rc=a,0!==i.length||u?{snapshot:new Ts(this.query,t.oc,r,i,t.ns,0==a,u,!1),Tc:s}:{Tc:s}},kh.prototype.Ec=function(t){return this.ds&&"Offline"===t?(this.ds=!1,this.fc({oc:this.oc,cc:new As,ns:this.ns,_c:!1},!1)):{Tc:[]}},kh.prototype.mc=function(t){return!this.nc.has(t)&&!!this.oc.has(t)&&!this.oc.get(t).At},kh.prototype.dc=function(t){var e=this;t&&(t.ws.forEach(function(t){return e.nc=e.nc.add(t)}),t.Ts.forEach(function(t){}),t.Es.forEach(function(t){return e.nc=e.nc.delete(t)}),this.ds=t.ds)},kh.prototype.wc=function(){var e=this;if(!this.ds)return[];var n=this.hc;this.hc=vs(),this.oc.forEach(function(t){e.mc(t.key)&&(e.hc=e.hc.add(t.key))});var r=[];return n.forEach(function(t){e.hc.has(t)||r.push(new Ku(t))}),this.hc.forEach(function(t){n.has(t)||r.push(new Zu(t))}),r},kh.prototype.Ic=function(t){this.nc=t.lo,this.hc=vs();var e=this.uc(t.documents);return this.fc(e,!0)},kh.prototype.Rc=function(){return Ts.os(this.query,this.oc,this.ns,0===this.rc)},kh),vh=(Dh.prototype.Vc=function(){this.pc()},Dh.prototype.pc=function(){var t=this;this.kr.lr(function(){return d(t,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return e=this.Ac.xu(),(n=this.yc(e))&&n.then(function(t){r.Rr.vr(function(){return e.commit().then(function(){r.Vr.resolve(t)}).catch(function(t){r.gc(t)})})}).catch(function(t){r.gc(t)}),[2]})})})},Dh.prototype.yc=function(t){try{var e=this.updateFunction(t);return!ri(e)&&e.catch&&e.then?e:(this.Vr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Vr.reject(t),null}},Dh.prototype.gc=function(t){var e=this;0<this.Pc&&this.bc(t)?(--this.Pc,this.Rr.vr(function(){return e.pc(),Promise.resolve()})):this.Vr.reject(t)},Dh.prototype.bc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Jo(e)},Dh),gh=(Object.defineProperty(Sh.prototype,"Bc",{get:function(){return!0},enumerable:!0,configurable:!0}),Sh.prototype.subscribe=function(t){this.Dc=t},Sh.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:return this.Uc("listen()"),(r=this.Fc.get(s))?(e=r.targetId,this.Sc.Yu(e),n=r.view.Rc(),[3,4]):[3,1];case 1:return[4,this.Ja.no(s.ee())];case 2:return i=t.sent(),o=this.Sc.Yu(i.targetId),e=i.targetId,[4,this.Qc(s,e,"current"===o)];case 3:n=t.sent(),this.Bc&&this.Ac.listen(i),t.label=4;case 4:return[2,n]}})})},Sh.prototype.Qc=function(a,u,h){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.Ja.uo(a,!0)];case 1:return e=t.sent(),n=new yh(a,e.lo),r=n.uc(e.documents),i=_s.fs(u,h&&"Offline"!==this.onlineState),o=n.fc(r,this.Bc,i),this.Wc(u,o.Tc),s=new $u(a,u,n),[2,(this.Fc.set(a,s),this.Nc.has(u)?this.Nc.get(u).push(a):this.Nc.set(u,[a]),o.snapshot)]}})})},Sh.prototype.pu=function(i){return d(this,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){switch(t.label){case 0:return this.Uc("unlisten()"),e=this.Fc.get(i),1<(n=this.Nc.get(e.targetId)).length?[2,(this.Nc.set(e.targetId,n.filter(function(t){return!t.isEqual(i)})),void this.Fc.delete(i))]:this.Bc?(this.Sc.Ju(e.targetId),this.Sc.sc(e.targetId)?[3,2]:[4,this.Ja.ao(e.targetId,!1).then(function(){r.Sc.tc(e.targetId),r.Ac.pu(e.targetId),r.jc(e.targetId)}).catch(Fa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.jc(e.targetId),[4,this.Ja.ao(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Sh.prototype.write=function(i,o){return d(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:this.Uc("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.Ja.yh(i)];case 2:return e=t.sent(),this.Sc.Ku(e.batchId),this.Gc(e.batchId,o),[4,this.Hc(e.bh)];case 3:return t.sent(),[4,this.Ac.Iu()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=Pa(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Sh.prototype.runTransaction=function(t,e,n){new vh(t,this.Ac,e,n).Vc()},Sh.prototype.xh=function(n){return d(this,void 0,void 0,function(){var e,r=this;return y(this,function(t){switch(t.label){case 0:this.Uc("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Ja.xh(n)];case 2:return e=t.sent(),n.as.forEach(function(t,e){var n=r.kc.get(e);n&&(Ks(t.ws.size+t.Ts.size+t.Es.size<=1),0<t.ws.size?n.vc=!0:0<t.Ts.size?Ks(n.vc):0<t.Es.size&&(Ks(n.vc),n.vc=!1))}),[4,this.Hc(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Fa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Sh.prototype.Ec=function(r,t){this.Uc("applyOnlineStateChange()");var i=[];this.Fc.forEach(function(t,e){var n=e.view.Ec(r);n.snapshot&&i.push(n.snapshot)}),this.Dc.Kc(r),this.Dc.Pa(i),this.onlineState=r},Sh.prototype.Cu=function(a,u){return d(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.Uc("rejectListens()"),this.Sc.Xu(a,"rejected",u),e=this.kc.get(a),(n=e&&e.key)?(r=(r=new Zo(Yr.N)).Re(n,new Io(n,Mr.min())),i=vs().add(n),o=new Ns(Mr.min(),new Map,new is(na),r,i),[4,this.xh(o)]):[3,2];case 1:return t.sent(),this.Lc=this.Lc.remove(n),this.kc.delete(a),this.zc(),[3,4];case 2:return[4,this.Ja.ao(a,!1).then(function(){return s.jc(a,u)}).catch(Fa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Sh.prototype.ku=function(r){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.Uc("applySuccessfulWrite()"),e=r.batch.batchId,this.Yc(e,null),this.Xc(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Ja.vh(r)];case 2:return n=t.sent(),this.Sc.zu(e,"acknowledged"),[4,this.Hc(n)];case 3:return t.sent(),[3,6];case 4:return[4,Fa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Sh.prototype.Mu=function(n,r){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.Uc("rejectFailedWrite()"),this.Yc(n,r),this.Xc(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Ja.Nh(n)];case 2:return e=t.sent(),this.Sc.zu(n,"rejected",r),[4,this.Hc(e)];case 3:return t.sent(),[3,6];case 4:return[4,Fa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Sh.prototype.Jc=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:this.Ac.ru()||Xs("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ja.kh()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Mc.get(e)||[]).push(o),this.Mc.set(e,n),[3,4]);case 3:return r=t.sent(),i=Pa(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Sh.prototype.Xc=function(t){(this.Mc.get(t)||[]).forEach(function(t){t.resolve()}),this.Mc.delete(t)},Sh.prototype.Zc=function(e){this.Mc.forEach(function(t){t.forEach(function(t){t.reject(new Sr(Rr.CANCELLED,e))})}),this.Mc.clear()},Sh.prototype.Gc=function(t,e){var n=this.qc[this.currentUser.s()];n=(n=n||new Zo(na)).Re(t,e),this.qc[this.currentUser.s()]=n},Sh.prototype.Yc=function(t,e){var n=this.qc[this.currentUser.s()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.qc[this.currentUser.s()]=n}},Sh.prototype.jc=function(t,e){var n=this;void 0===e&&(e=null),this.Sc.Ju(t);for(var r=0,i=this.Nc.get(t);r<i.length;r++){var o=i[r];this.Fc.delete(o),e&&this.Dc.tl(o,e)}this.Nc.delete(t),this.Bc&&this.Oc.Ao(t).forEach(function(t){n.Oc.po(t)||n.el(t)})},Sh.prototype.el=function(t){var e=this.Lc.get(t);null!==e&&(this.Ac.pu(e),this.Lc=this.Lc.remove(t),this.kc.delete(e),this.zc())},Sh.prototype.Wc=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Zu?(this.Oc.Zh(i.key,t),this.sl(i)):i instanceof Ku?(Xs("SyncEngine","Document no longer in limbo: "+i.key),this.Oc.to(i.key,t),this.Oc.po(i.key)||this.el(i.key)):Zs()}},Sh.prototype.sl=function(t){var e=t.key;this.Lc.get(e)||(Xs("SyncEngine","New document in limbo: "+e),this.$c.push(e),this.zc())},Sh.prototype.zc=function(){for(;0<this.$c.length&&this.Lc.size<this.Cc;){var t=this.$c.shift(),e=this.xc.next();this.kc.set(e,new th(t)),this.Lc=this.Lc.Re(t,e),this.Ac.listen(new Mo(No.Wt(t.path).ee(),e,2,la.er))}},Sh.prototype.il=function(){return this.Lc},Sh.prototype.nl=function(){return this.$c},Sh.prototype.Hc=function(r,u){return d(this,void 0,void 0,function(){var o,s,e,a=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Fc.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.uc(r);return n._c?a.Ja.uo(i.query,!1).then(function(t){var e=t.documents;return i.view.uc(e,n)}):n}).then(function(t){var e=u&&u.as.get(i.targetId),n=i.view.fc(t,a.Bc,e);if(a.Wc(i.targetId,n.Tc),n.snapshot){a.Bc&&a.Sc.Xu(i.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var r=fa.Yn(i.targetId,n.snapshot);s.push(r)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Dc.Pa(o),[4,this.Ja.Jh(s)];case 2:return t.sent(),[2]}})})},Sh.prototype.Uc=function(t){},Sh.prototype.Bu=function(r){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(r),this.currentUser=r,e?(this.Zc("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.Ja.Rh(r)]):[3,3];case 1:return n=t.sent(),this.Sc.Rh(r,n.Vh,n.ph),[4,this.Hc(n.Ph)];case 2:t.sent(),t.label=3;case 3:return[4,this.Ac.Bu()];case 4:return t.sent(),[2]}})})},Sh.prototype.enableNetwork=function(){return this.Ac.enableNetwork()},Sh.prototype.disableNetwork=function(){return this.Ac.disableNetwork()},Sh.prototype.ei=function(t){var e=this.kc.get(t);if(e&&e.vc)return vs().add(e.key);var n=vs(),r=this.Nc.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],a=this.Fc.get(s);n=n.ze(a.view.ac)}return n},Sh),mh=(Rh.prototype.listen=function(a){return d(this,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:if(e=a.query,n=!1,(r=this.ol.get(e))||(n=!0,r=new eh),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.gu.listen(e)];case 2:return i.rl=t.sent(),[3,4];case 3:return o=t.sent(),s=Pa(o,"Initialization of query '"+a.query+"' failed"),[2,void a.onError(s)];case 4:return this.ol.set(e,r),r.hl.push(a),a.Ec(this.onlineState),r.rl&&a.ul(r.rl)&&this.cl(),[2]}})})},Rh.prototype.pu=function(o){return d(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){return e=o.query,n=!1,(r=this.ol.get(e))&&0<=(i=r.hl.indexOf(o))&&(r.hl.splice(i,1),n=0===r.hl.length),n?[2,(this.ol.delete(e),this.gu.pu(e))]:[2]})})},Rh.prototype.Pa=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.ol.get(o);if(s){for(var a=0,u=s.hl;a<u.length;a++)u[a].ul(i)&&(e=!0);s.rl=i}}e&&this.cl()},Rh.prototype.tl=function(t,e){var n=this.ol.get(t);if(n)for(var r=0,i=n.hl;r<i.length;r++)i[r].onError(e);this.ol.delete(t)},Rh.prototype.Kc=function(i){this.onlineState=i;var o=!1;this.ol.forEach(function(t,e){for(var n=0,r=e.hl;n<r.length;n++)r[n].Ec(i)&&(o=!0)}),o&&this.cl()},Rh.prototype.ll=function(t){this.al.add(t),t.next()},Rh.prototype._l=function(t){this.al.delete(t)},Rh.prototype.cl=function(){this.al.forEach(function(t){t.next()})},Rh),wh=(_h.prototype.ul=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ts(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.dl?this.Tl(t)&&(this.fl.next(t),o=!0):this.El(t,this.onlineState)&&(this.ml(t),o=!0),this.wl=t,o},_h.prototype.onError=function(t){this.fl.error(t)},_h.prototype.Ec=function(t){this.onlineState=t;var e=!1;return this.wl&&!this.dl&&this.El(this.wl,t)&&(this.ml(this.wl),e=!0),e},_h.prototype.El=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Il&&n||t.docs.M()&&"Offline"!==e)},_h.prototype.Tl=function(t){if(0<t.docChanges.length)return!0;var e=this.wl&&this.wl.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},_h.prototype.ml=function(t){t=Ts.os(t.query,t.docs,t.ns,t.fromCache),this.dl=!0,this.fl.next(t)},_h),bh=(Nh.prototype.Ih=function(t){this.Rl=t},Nh.prototype.Bn=function(e,r,i,o){var s=this;return r.te()||i.isEqual(Mr.min())?this.Al(e,r):this.Rl.qn(e,o).next(function(t){var n=s.Pl(r,t);return(r.oe()||r.ae())&&s._c(r.xt,n,o,i)?s.Al(e,r):(Ws()<=a.DEBUG&&Xs("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),r.toString()),s.Rl.Bn(e,r,i).next(function(e){return n.forEach(function(t){e=e.Re(t.key,t)}),e}))})},Nh.prototype.Pl=function(n,t){var r=new is(function(t,e){return n.se(t,e)});return t.forEach(function(t,e){e instanceof Eo&&n.matches(e)&&(r=r.add(e))}),r},Nh.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.S(r))},Nh.prototype.Al=function(t,e){return Ws()<=a.DEBUG&&Xs("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Rl.Bn(t,e,Mr.min())},Nh),Eh=(Th.prototype.yl=function(t){return ha.resolve(0===this.Dn.length)},Th.prototype.vh=function(t,e,n){var r=e.batchId,i=this.gl(r,"acknowledged");return Ks(0===i),this.Dn[i],this.lastStreamToken=n,ha.resolve()},Th.prototype.Oh=function(t){return ha.resolve(this.lastStreamToken)},Th.prototype.qh=function(t,e){return this.lastStreamToken=e,ha.resolve()},Th.prototype.gh=function(t,e,n,r){var i=this.Vl;this.Vl++,0<this.Dn.length&&this.Dn[this.Dn.length-1];var o=new aa(i,e,n,r);this.Dn.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.pl=this.pl.add(new Ga(u.key,i)),this.Fn.Tr(t,u.key.path.k())}return ha.resolve(o)},Th.prototype.$h=function(t,e){return ha.resolve(this.bl(e))},Th.prototype.so=function(t,e){var n=e+1,r=this.vl(n),i=r<0?0:r;return ha.resolve(this.Dn.length>i?this.Dn[i]:null)},Th.prototype.kh=function(){return ha.resolve(0===this.Dn.length?-1:this.Vl-1)},Th.prototype.Ah=function(t){return ha.resolve(this.Dn.slice())},Th.prototype.$n=function(t,e){var n=this,r=new Ga(e,0),i=new Ga(e,Number.POSITIVE_INFINITY),o=[];return this.pl.Ge([r,i],function(t){var e=n.bl(t.yo);o.push(e)}),ha.resolve(o)},Th.prototype.xn=function(t,e){var r=this,i=new is(na);return e.forEach(function(t){var e=new Ga(t,0),n=new Ga(t,Number.POSITIVE_INFINITY);r.pl.Ge([e,n],function(t){i=i.add(t.yo)})}),ha.resolve(this.Sl(i))},Th.prototype.Gn=function(t,e){var n=e.path,r=n.length+1,i=n;Yr.et(i)||(i=i.child(""));var o=new Ga(new Yr(i),0),s=new is(na);return this.pl.He(function(t){var e=t.key.path;return!!n.B(e)&&(e.length===r&&(s=s.add(t.yo)),!0)},o),ha.resolve(this.Sl(s))},Th.prototype.Sl=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.bl(t);null!==e&&r.push(e)}),r},Th.prototype.Lh=function(n,r){var i=this;Ks(0===this.gl(r.batchId,"removed")),this.Dn.shift();var o=this.pl;return ha.forEach(r.mutations,function(t){var e=new Ga(t.key,r.batchId);return o=o.delete(e),i.zh.Cl(n,t.key)}).next(function(){i.pl=o})},Th.prototype.Dl=function(t){},Th.prototype.po=function(t,e){var n=new Ga(e,0),r=this.pl.Ke(n);return ha.resolve(e.isEqual(r&&r.key))},Th.prototype.Fh=function(t){return this.Dn.length,ha.resolve()},Th.prototype.gl=function(t,e){return this.vl(t)},Th.prototype.vl=function(t){return 0===this.Dn.length?0:t-this.Dn[0].batchId},Th.prototype.bl=function(t){var e=this.vl(t);return e<0||e>=this.Dn.length?null:this.Dn[e]},Th),Ih=(Ah.prototype.Hh=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Fl(e);return this.docs=this.docs.Re(r,{Nl:e,size:s,readTime:n}),this.size+=s-o,this.Fn.Tr(t,r.path.k())},Ah.prototype.Gh=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ah.prototype.kn=function(t,e){var n=this.docs.get(e);return ha.resolve(n?n.Nl:null)},Ah.prototype.getEntries=function(t,e){var n=this,r=cs();return e.forEach(function(t){var e=n.docs.get(t);r=r.Re(t,e?e.Nl:null)}),ha.resolve(r)},Ah.prototype.Bn=function(t,e,n){for(var r=ls(),i=new Yr(e.path.child("")),o=this.docs.ve(i);o.$e();){var s=o.Ne(),a=s.key,u=s.value,h=u.Nl,c=u.readTime;if(!e.path.B(a.path))break;c.S(n)<=0||h instanceof Eo&&e.matches(h)&&(r=r.Re(h.key,h))}return ha.resolve(r)},Ah.prototype.$l=function(t,e){return ha.forEach(this.docs,function(t){return e(t)})},Ah.prototype.Sh=function(t){return new Ah.Ll(this)},Ah.prototype.kl=function(t){return ha.resolve(this.size)},Ah);function Ah(t,e){this.Fn=t,this.Fl=e,this.docs=new Zo(Yr.N),this.size=0}function Th(t,e){this.Fn=t,this.zh=e,this.Dn=[],this.Vl=1,this.lastStreamToken=ei.ht,this.pl=new is(Ga.wo)}function Nh(){}function _h(t,e,n){this.query=t,this.fl=e,this.dl=!1,this.wl=null,this.onlineState="Unknown",this.options=n||{}}function Rh(t){this.gu=t,this.ol=new sa(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.al=new Set,this.gu.subscribe(this)}function Sh(t,e,n,r,i){this.Ja=t,this.Ac=e,this.Sc=n,this.currentUser=r,this.Cc=i,this.Dc=null,this.Fc=new sa(function(t){return t.canonicalId()}),this.Nc=new Map,this.$c=[],this.Lc=new Zo(Yr.N),this.kc=new Map,this.Oc=new ja,this.qc={},this.Mc=new Map,this.xc=Na.Ir(),this.onlineState="Unknown"}function Dh(t,e,n,r){this.Rr=t,this.Ac=e,this.updateFunction=n,this.Vr=r,this.Pc=5,this.kr=new Ia(this.Rr,"transaction_retry")}function kh(t,e){this.query=t,this.nc=e,this.rc=null,this.ds=!1,this.hc=vs(),this.ns=vs(),this.oc=new Is(t.se.bind(t))}function Lh(){this.Gu=new ph,this.Hu={},this.gu=null,this.Qa=null,this.Xn=null}function Oh(){this.activeTargetIds=ms()}function Vh(t,e,n,r,i){var o,s,a,u,h,c,f,l,p=this;this.Ja=t,this.$a=e,this.Rr=n,this.Za=[],this.tu=new Map,this.eu=null,this.networkEnabled=!1,this.isPrimary=!1,this.su=!1,this.iu=i,this.iu.nu(function(t){n.vr(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ru()?(Xs("RemoteStore","Restarting streams for network reachability change."),[4,this.hu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.ou=new fh(n,r),this.au=(h=this.$a,c=n,f={Ra:this.uu.bind(this),wa:this.cu.bind(this),Pa:this.lu.bind(this)},l=$s(h),new ah(c,l.sa,l.credentials,l.serializer,f)),this._u=(o=this.$a,s=n,a={Ra:this.fu.bind(this),wa:this.du.bind(this),Sa:this.wu.bind(this),va:this.va.bind(this)},u=$s(o),new uh(s,u.sa,u.credentials,u.serializer,a))}function Mh(t,e){this.Rr=t,this.Qa=e,this.state="Unknown",this.Wa=0,this.ja=null,this.Ga=!0}function Ph(t){this.$a=t,this.La=ds(),this.mutations=[],this.ka=!1,this.Oa=null,this.qa=new Set}function Ch(t,e,n){var r=this;return(r=nh.call(this)||this).sa=t,r.credentials=e,r.serializer=n,r}function Uh(t,e,n,r,i){var o=this;return(o=rh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ya=!1,o.lastStreamToken=ei.ht,o}function qh(t,e,n,r,i){var o=this;return(o=ih.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function xh(t,e,n,r,i,o){this.sr=t,this.ea=n,this.sa=r,this.ia=i,this.listener=o,this.state=0,this.na=0,this.ra=null,this.stream=null,this.kr=new Ia(t,e)}function Fh(t){var e=this;return(e=oh.call(this)||this).Ul=t,e}function jh(){this.bh=new sa(function(t){return t.toString()}),this.Ol=!1}Ih.Ll=(Object.defineProperty(jh.prototype,"readTime",{get:function(){return this.ql},set:function(t){this.ql=t},enumerable:!0,configurable:!0}),jh.prototype.Hh=function(t,e){this.Ml(),this.readTime=e,this.bh.set(t.key,t)},jh.prototype.Gh=function(t,e){this.Ml(),e&&(this.readTime=e),this.bh.set(t,null)},jh.prototype.kn=function(t,e){this.Ml();var n=this.bh.get(e);return void 0!==n?ha.resolve(n):this.xl(t,e)},jh.prototype.getEntries=function(t,e){return this.Bl(t,e)},jh.prototype.apply=function(t){return this.Ml(),this.Ol=!0,this.fc(t)},jh.prototype.Ml=function(){},n(Fh,oh=jh),Fh.prototype.fc=function(n){var r=this,i=[];return this.bh.forEach(function(t,e){e?i.push(r.Ul.Hh(n,e,r.readTime)):r.Ul.Gh(t)}),ha.vn(i)},Fh.prototype.xl=function(t,e){return this.Ul.kn(t,e)},Fh.prototype.Bl=function(t,e){return this.Ul.getEntries(t,e)},Fh);var Gh,Bh=(rc.prototype.js=function(t,n){return this.Ql.forEach(function(t,e){return n(e)}),ha.resolve()},rc.prototype.Mh=function(t){return ha.resolve(this.lastRemoteSnapshotVersion)},rc.prototype.Hl=function(t){return ha.resolve(this.Wl)},rc.prototype.ho=function(t){return this.highestTargetId=this.Gl.next(),ha.resolve(this.highestTargetId)},rc.prototype.Yh=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Wl&&(this.Wl=e),ha.resolve()},rc.prototype.Kl=function(t){this.Ql.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Gl=new Na(e),this.highestTargetId=e),t.sequenceNumber>this.Wl&&(this.Wl=t.sequenceNumber)},rc.prototype.oo=function(t,e){return this.Kl(e),this.targetCount+=1,ha.resolve()},rc.prototype.jh=function(t,e){return this.Kl(e),ha.resolve()},rc.prototype.zl=function(t,e){return this.Ql.delete(e.target),this.jl.Ao(e.targetId),--this.targetCount,ha.resolve()},rc.prototype.Yl=function(n,r,i){var o=this,s=0,a=[];return this.Ql.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Ql.delete(t),a.push(o.Xl(n,e.targetId)),s++)}),ha.vn(a).next(function(){return s})},rc.prototype.Jl=function(t){return ha.resolve(this.targetCount)},rc.prototype.ro=function(t,e){var n=this.Ql.get(e)||null;return ha.resolve(n)},rc.prototype.Uh=function(t,e,n){return this.jl.mo(e,n),ha.resolve()},rc.prototype.Bh=function(e,t,n){this.jl.Ro(t,n);var r=this.persistence.zh,i=[];return r&&t.forEach(function(t){i.push(r.Cl(e,t))}),ha.vn(i)},rc.prototype.Xl=function(t,e){return this.jl.Ao(e),ha.resolve()},rc.prototype.co=function(t,e){var n=this.jl.Vo(e);return ha.resolve(n)},rc.prototype.po=function(t,e){return ha.resolve(this.jl.po(e))},rc),zh=(nc.prototype.start=function(){return Promise.resolve()},nc.prototype.Pu=function(){return this.e_=!1,Promise.resolve()},Object.defineProperty(nc.prototype,"i_",{get:function(){return this.e_},enumerable:!0,configurable:!0}),nc.prototype.n_=function(){},nc.prototype.mh=function(){return this.Fn},nc.prototype._h=function(t){var e=this.Zl[t.s()];return e||(e=new Eh(this.Fn,this.zh),this.Zl[t.s()]=e),e},nc.prototype.Th=function(){return this.wh},nc.prototype.dh=function(){return this.Cn},nc.prototype.runTransaction=function(t,e,n){var r=this;Xs("MemoryPersistence","Starting transaction:",t);var i=new Hh(this.t_.next());return this.zh.r_(),n(i).next(function(t){return r.zh.h_(i).next(function(){return t})}).gn().then(function(t){return i.o_(),t})},nc.prototype.a_=function(e,n){return ha.Sn(Object.values(this.Zl).map(function(t){return function(){return t.po(e,n)}}))},nc),Hh=(ec.prototype.c_=function(t){this.u_.push(t)},ec.prototype.o_=function(){this.u_.forEach(function(t){return t()})},n(tc,Gh=ec),tc),Wh=($h.f_=function(t){return new $h(t)},Object.defineProperty($h.prototype,"d_",{get:function(){if(this.__)return this.__;throw Zs()},enumerable:!0,configurable:!0}),$h.prototype.Zh=function(t,e,n){return this.l_.Zh(n,e),this.d_.delete(n),ha.resolve()},$h.prototype.to=function(t,e,n){return this.l_.to(n,e),this.d_.add(n),ha.resolve()},$h.prototype.Cl=function(t,e){return this.d_.add(e),ha.resolve()},$h.prototype.removeTarget=function(t,e){var n=this;this.l_.Ao(e.targetId).forEach(function(t){return n.d_.add(t)});var r=this.persistence.Th();return r.co(t,e.targetId).next(function(t){t.forEach(function(t){return n.d_.add(t)})}).next(function(){return r.zl(t,e)})},$h.prototype.r_=function(){this.__=new Set},$h.prototype.h_=function(t){var n=this,r=this.persistence.dh().Sh();return ha.forEach(this.d_,function(e){return n.w_(t,e).next(function(t){t||r.Gh(e)})}).next(function(){return n.__=null,r.apply(t)})},$h.prototype.Kh=function(t,e){var n=this;return this.w_(t,e).next(function(t){t?n.d_.delete(e):n.d_.add(e)})},$h.prototype.s_=function(t){return 0},$h.prototype.w_=function(t,e){var n=this;return ha.Sn([function(){return ha.resolve(n.l_.po(e))},function(){return n.persistence.Th().po(t,e)},function(){return n.persistence.a_(t,e)}])},$h),Qh=(Kh.prototype.initialize=function(n){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.Sc=this.T_(n),this.persistence=this.E_(n),[4,this.persistence.start()];case 1:return t.sent(),this.m_=this.I_(n),this.Ja=this.R_(n),this.Ac=this.A_(n),this.gu=this.P_(n),this.V_=this.p_(n),this.Sc.Qa=function(t){return e.gu.Ec(t,1)},this.Ac.gu=this.gu,[4,this.Ja.start()];case 2:return t.sent(),[4,this.Sc.start()];case 3:return t.sent(),[4,this.Ac.start()];case 4:return t.sent(),[4,this.Ac.Uu(this.gu.Bc)];case 5:return t.sent(),[2]}})})},Kh.prototype.p_=function(t){return new mh(this.gu)},Kh.prototype.I_=function(t){return null},Kh.prototype.R_=function(t){return new qa(this.persistence,new bh,t.y_)},Kh.prototype.E_=function(t){return new zh(Wh.f_)},Kh.prototype.A_=function(t){var e=this;return new lh(this.Ja,t.$a,t.Rr,function(t){return e.gu.Ec(t,0)},t.platform.g_())},Kh.prototype.T_=function(t){return new dh},Kh.prototype.P_=function(t){return new gh(this.Ja,this.Ac,this.Sc,t.y_,t.Cc)},Kh.prototype.clearPersistence=function(t){throw new Sr(Rr.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},Kh),Xh=(Zh.prototype.start=function(e,n){var r=this;this.v_();var i=new Ea,o=new Ea,s=!1;return this.credentials._(function(t){if(!s)return s=!0,Xs("FirestoreClient","Initializing. user=",t.uid),r.S_(e,n,t,o).then(i.resolve,i.reject);r.Rr.vr(function(){return r.Bu(t)})}),this.Rr.vr(function(){return i.promise}),o.promise},Zh.prototype.enableNetwork=function(){var t=this;return this.v_(),this.Rr.enqueue(function(){return t.gu.enableNetwork()})},Zh.prototype.S_=function(u,h,c,f){return d(this,void 0,void 0,function(){var r,i,o,s,a=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.C_(this.b_)];case 1:return r=t.sent(),i=this.platform.Go(this.b_.ii),e=r,n=this.credentials,o=new hh(e,n,i),[4,u.initialize({Rr:this.Rr,b_:this.b_,platform:this.platform,$a:o,clientId:this.clientId,y_:c,Cc:100,D_:h})];case 2:return t.sent(),this.persistence=u.persistence,this.Sc=u.Sc,this.Ja=u.Ja,this.Ac=u.Ac,this.gu=u.gu,this.m_=u.m_,this.F_=u.V_,this.persistence.n_(function(){return d(a,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),f.resolve(),[3,4];case 3:if(s=t.sent(),f.reject(s),!this.N_(s))throw s;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),this.S_(new Qh,{L_:!1},c,f))];case 4:return[2]}var e,n})})},Zh.prototype.N_=function(t){return"FirebaseError"===t.name?t.code===Rr.FAILED_PRECONDITION||t.code===Rr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Zh.prototype.v_=function(){if(this.Rr.Mr)throw new Sr(Rr.FAILED_PRECONDITION,"The client has already been terminated.")},Zh.prototype.Bu=function(t){return this.Rr.Hr(),Xs("FirestoreClient","Credential Changed. Current user: "+t.uid),this.gu.Bu(t)},Zh.prototype.disableNetwork=function(){var t=this;return this.v_(),this.Rr.enqueue(function(){return t.gu.disableNetwork()})},Zh.prototype.terminate=function(){var t=this;return this.Rr.Wr(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.m_&&this.m_.stop(),[4,this.Ac.Pu()];case 1:return t.sent(),[4,this.Sc.Pu()];case 2:return t.sent(),[4,this.persistence.Pu()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},Zh.prototype.waitForPendingWrites=function(){var t=this;this.v_();var e=new Ea;return this.Rr.vr(function(){return t.gu.Jc(e)}),e.promise},Zh.prototype.listen=function(t,e,n){var r=this;this.v_();var i=new wh(t,e,n);return this.Rr.vr(function(){return r.F_.listen(i)}),i},Zh.prototype.pu=function(t){var e=this;this.k_||this.Rr.vr(function(){return e.F_.pu(t)})},Zh.prototype.O_=function(o){return d(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){switch(t.label){case 0:return this.v_(),i=new Ea,[4,this.Rr.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Ja.io(o)];case 1:return(e=t.sent())instanceof Eo?i.resolve(e):e instanceof Io?i.resolve(null):i.reject(new Sr(Rr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=Pa(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},Zh.prototype.q_=function(u){return d(this,void 0,void 0,function(){var a,e=this;return y(this,function(t){switch(t.label){case 0:return this.v_(),a=new Ea,[4,this.Rr.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,r,i,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Ja.uo(u,!0)];case 1:return e=t.sent(),n=new yh(u,e.lo),r=n.uc(e.documents),i=n.fc(r,!1),a.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Pa(o,"Failed to execute query '"+u+" against cache"),a.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),a.promise)]}})})},Zh.prototype.write=function(t){var e=this;this.v_();var n=new Ea;return this.Rr.vr(function(){return e.gu.write(t,n)}),n.promise},Zh.prototype.ii=function(){return this.b_.ii},Zh.prototype.ll=function(t){var e=this;this.v_(),this.Rr.vr(function(){return e.F_.ll(t),Promise.resolve()})},Zh.prototype._l=function(t){var e=this;this.k_||this.Rr.vr(function(){return e.F_._l(t),Promise.resolve()})},Object.defineProperty(Zh.prototype,"k_",{get:function(){return this.Rr.Mr},enumerable:!0,configurable:!0}),Zh.prototype.transaction=function(t){var e=this;this.v_();var n=new Ea;return this.Rr.vr(function(){return e.gu.runTransaction(e.Rr,t,n),Promise.resolve()}),n.promise},Zh),Jh=(Yh.prototype.next=function(t){this.M_(this.observer.next,t)},Yh.prototype.error=function(t){this.M_(this.observer.error,t)},Yh.prototype.x_=function(){this.muted=!0},Yh.prototype.M_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Yh);function Yh(t){this.observer=t,this.muted=!1}function Zh(t,e,n,r){this.platform=t,this.b_=e,this.credentials=n,this.Rr=r,this.clientId=ta.cn()}function Kh(){}function $h(t){this.persistence=t,this.l_=new ja,this.__=null}function tc(t){var e=this;return(e=Gh.call(this)||this).Qh=t,e}function ec(){this.u_=[]}function nc(t){var e=this;this.Zl={},this.t_=new la(0),this.e_=!1,this.e_=!0,this.zh=t(this),this.wh=new Bh(this),this.Fn=new Aa,this.Cn=new Ih(this.Fn,function(t){return e.zh.s_(t)})}function rc(t){this.persistence=t,this.Ql=new sa(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Mr.min(),this.highestTargetId=0,this.Wl=0,this.jl=new ja,this.targetCount=0,this.Gl=Na.mr()}function ic(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var oc,sc,ac=(Lc.prototype.U_=function(t){switch(ui(t)){case 0:return null;case 1:return t.booleanValue;case 2:return yi(t.integerValue||t.doubleValue);case 3:return this.Q_(t.timestampValue);case 4:return this.W_(t);case 5:return t.stringValue;case 6:return new fu(vi(t.bytesValue));case 7:return this.j_(t.referenceValue);case 8:return this.G_(t.geoPointValue);case 9:return this.H_(t.arrayValue);case 10:return this.K_(t.mapValue);default:throw Zs()}},Lc.prototype.K_=function(t){var n=this,r={};return $r(t.fields||{},function(t,e){r[t]=n.U_(e)}),r},Lc.prototype.G_=function(t){return new Ru(yi(t.latitude),yi(t.longitude))},Lc.prototype.H_=function(t){var e=this;return(t.values||[]).map(function(t){return e.U_(t)})},Lc.prototype.W_=function(t){switch(this.B_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return oi(n)?t(n):n}(t);return null==e?null:this.U_(e);case"estimate":return this.Q_(si(t));default:return null}},Lc.prototype.Q_=function(t){var e=di(t),n=new Vr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Lc.prototype.j_=function(t){var e=Cr.G(t);Ks(Gs(e));var n=new oa(e.get(1),e.get(3)),r=new Yr(e.L(5));return n.isEqual(this.firestore.Zo)||Js("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.Zo.projectId+"/"+this.firestore.Zo.database+") instead."),new pc(r,this.firestore,this.converter)},Lc),uc=Ca.ih,hc=(kc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},kc),cc=(Dc.prototype.settings=function(t){Wa("Firestore.settings",arguments,1),Ja("Firestore.settings","object",1,t);var e=new hc(t);if(this.J_&&!this.if.isEqual(e))throw new Sr(Rr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.if=e).credentials&&(this.ef=function(t){if(!t)return new Dr;switch(t.type){case"gapi":var e=t.rf;return Ks(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Or(e,t.V||"0");case"provider":return t.rf;default:throw new Sr(Rr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Dc.prototype.enableNetwork=function(){return this.X_(),this.J_.enableNetwork()},Dc.prototype.disableNetwork=function(){return this.X_(),this.J_.disableNetwork()},Dc.prototype.enablePersistence=function(t){var e,n;if(this.J_)throw new Sr(Rr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1;return t&&(void 0!==t.experimentalTabSynchronization&&Js("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.hf(this.sf,{L_:!0,cacheSizeBytes:this.if.cacheSizeBytes,synchronizeTabs:r})},Dc.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var r,e=this;return y(this,function(t){if(void 0!==this.J_&&!this.J_.k_)throw new Sr(Rr.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return r=new Ea,[2,(this.Y_.xr(function(){return d(e,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.af(),[4,this.sf.clearPersistence(e)];case 1:return t.sent(),r.resolve(),[3,3];case 2:return n=t.sent(),r.reject(n),[3,3];case 3:return[2]}})})}),r.promise)]})})},Dc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Dc.prototype,"uf",{get:function(){return this.X_(),this.J_.k_},enumerable:!0,configurable:!0}),Dc.prototype.waitForPendingWrites=function(){return this.X_(),this.J_.waitForPendingWrites()},Dc.prototype.onSnapshotsInSync=function(t){if(this.X_(),ic(t))return this.cf(t);Ja("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.cf(e)},Dc.prototype.cf=function(t){var e=this,n=new Jh({next:function(){t.next&&t.next()},error:function(t){throw Zs()}});return this.J_.ll(n),function(){n.x_(),e.J_._l(n)}},Dc.prototype.X_=function(){return this.J_||this.hf(new Qh,{L_:!1}),this.J_},Dc.prototype.af=function(){return new ia(this.Zo,this.tf,this.if.host,this.if.ssl,this.if.forceLongPolling)},Dc.prototype.hf=function(t,e){var n=this.af();return this.J_=new Xh(Bs.nt(),n,this.ef,this.Y_),this.J_.start(t,e)},Dc.Z_=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Sr(Rr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Sr(Rr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new oa(n)},Object.defineProperty(Dc.prototype,"app",{get:function(){if(!this.z_)throw new Sr(Rr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.z_},enumerable:!0,configurable:!0}),Dc.prototype.collection=function(t){return Wa("Firestore.collection",arguments,1),Ja("Firestore.collection","non-empty string",1,t),this.X_(),new wc(Cr.G(t),this)},Dc.prototype.doc=function(t){return Wa("Firestore.doc",arguments,1),Ja("Firestore.doc","non-empty string",1,t),this.X_(),pc.lf(Cr.G(t),this)},Dc.prototype.collectionGroup=function(t){if(Wa("Firestore.collectionGroup",arguments,1),Ja("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Sr(Rr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.X_(),new gc(new No(Cr.H,t),this)},Dc.prototype.runTransaction=function(e){var n=this;return Wa("Firestore.runTransaction",arguments,1),Ja("Firestore.runTransaction","function",1,e),this.X_().transaction(function(t){return e(new fc(n,t))})},Dc.prototype.batch=function(){return this.X_(),new lc(this)},Object.defineProperty(Dc,"logLevel",{get:function(){switch(Ws()){case a.DEBUG:return"debug";case a.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),Dc.setLogLevel=function(t){switch(Wa("Firestore.setLogLevel",arguments,1),Ja("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":Qs(a.DEBUG);break;case"error":Qs(a.ERROR);break;case"silent":Qs(a.SILENT);break;default:throw new Sr(Rr.INVALID_ARGUMENT,"Invalid log level: "+t)}},Dc.prototype._f=function(){return this.if.timestampsInSnapshots},Dc),fc=(Sc.prototype.get=function(t){var n=this;Wa("Transaction.get",arguments,1);var r=Pc("Transaction.get",t,this.ff);return this.df.Ma([r.ta]).then(function(t){if(!t||1!==t.length)return Zs();var e=t[0];if(e instanceof Io)return new yc(n.ff,r.ta,null,!1,!1,r.wf);if(e instanceof Eo)return new yc(n.ff,r.ta,e,!1,!1,r.wf);throw Zs()})},Sc.prototype.set=function(t,e,n){Xa("Transaction.set",arguments,2,3);var r=Pc("Transaction.set",t,this.ff);n=Oc("Transaction.set",n);var i=Cc(r.wf,e,"Transaction.set"),o=i[0],s=i[1],a=n.merge||n.mergeFields?this.ff.nf.zo(s,o,n.mergeFields):this.ff.nf.Ho(s,o);return this.df.set(r.ta,a),this},Sc.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof lu?(Qa("Transaction.update",arguments,3),r=Pc("Transaction.update",t,this.ff),this.ff.nf.Xo("Transaction.update",e,n,o)):(Wa("Transaction.update",arguments,2),r=Pc("Transaction.update",t,this.ff),this.ff.nf.Yo("Transaction.update",e)),this.df.update(r.ta,i),this},Sc.prototype.delete=function(t){Wa("Transaction.delete",arguments,1);var e=Pc("Transaction.delete",t,this.ff);return this.df.delete(e.ta),this},Sc),lc=(Rc.prototype.set=function(t,e,n){Xa("WriteBatch.set",arguments,2,3),this.mf();var r=Pc("WriteBatch.set",t,this.ff);n=Oc("WriteBatch.set",n);var i=Cc(r.wf,e,"WriteBatch.set"),o=i[0],s=i[1],a=n.merge||n.mergeFields?this.ff.nf.zo(s,o,n.mergeFields):this.ff.nf.Ho(s,o);return this.Tf=this.Tf.concat(a.Mo(r.ta,Fi.dt())),this},Rc.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.mf(),i="string"==typeof e||e instanceof lu?(Qa("WriteBatch.update",arguments,3),r=Pc("WriteBatch.update",t,this.ff),this.ff.nf.Xo("WriteBatch.update",e,n,o)):(Wa("WriteBatch.update",arguments,2),r=Pc("WriteBatch.update",t,this.ff),this.ff.nf.Yo("WriteBatch.update",e)),this.Tf=this.Tf.concat(i.Mo(r.ta,Fi.exists(!0))),this},Rc.prototype.delete=function(t){Wa("WriteBatch.delete",arguments,1),this.mf();var e=Pc("WriteBatch.delete",t,this.ff);return this.Tf=this.Tf.concat(new Hi(e.ta,Fi.dt())),this},Rc.prototype.commit=function(){return this.mf(),this.Ef=!0,0<this.Tf.length?this.ff.X_().write(this.Tf):Promise.resolve()},Rc.prototype.mf=function(){if(this.Ef)throw new Sr(Rr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Rc),pc=(_c.lf=function(t,e,n){if(t.length%2!=0)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.j()+" has "+t.length);return new _c(new Yr(t),e,n)},Object.defineProperty(_c.prototype,"id",{get:function(){return this.ta.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(_c.prototype,"parent",{get:function(){return new wc(this.ta.path.k(),this.firestore,this.wf)},enumerable:!0,configurable:!0}),Object.defineProperty(_c.prototype,"path",{get:function(){return this.ta.path.j()},enumerable:!0,configurable:!0}),_c.prototype.collection=function(t){if(Wa("DocumentReference.collection",arguments,1),Ja("DocumentReference.collection","non-empty string",1,t),!t)throw new Sr(Rr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Cr.G(t);return new wc(this.ta.path.child(e),this.firestore)},_c.prototype.isEqual=function(t){if(!(t instanceof _c))throw ou("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ta.isEqual(t.ta)&&this.wf===t.wf},_c.prototype.set=function(t,e){Xa("DocumentReference.set",arguments,1,2),e=Oc("DocumentReference.set",e);var n=Cc(this.wf,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.nf.zo(i,r,e.mergeFields):this.firestore.nf.Ho(i,r);return this.J_.write(o.Mo(this.ta,Fi.dt()))},_c.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof lu?(Qa("DocumentReference.update",arguments,2),this.firestore.nf.Xo("DocumentReference.update",t,e,r)):(Wa("DocumentReference.update",arguments,1),this.firestore.nf.Yo("DocumentReference.update",t)),this.J_.write(n.Mo(this.ta,Fi.exists(!0)))},_c.prototype.delete=function(){return Wa("DocumentReference.delete",arguments,0),this.J_.write([new Hi(this.ta,Fi.dt())])},_c.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xa("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||ic(t[i])||(iu("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),Ka("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return n=ic(t[i])?t[i]:(Ja("DocumentReference.onSnapshot","function",i,t[i]),Ya("DocumentReference.onSnapshot","function",i+1,t[i+1]),Ya("DocumentReference.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.If(o,n)},_c.prototype.If=function(t,n){var r=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var i=new Jh({next:function(t){if(n.next){var e=t.docs.get(r.ta);n.next(new yc(r.firestore,r.ta,e,t.fromCache,t.hasPendingWrites,r.wf))}},error:e}),o=this.J_.listen(No.Wt(this.ta.path),i,t);return function(){i.x_(),r.J_.pu(o)}},_c.prototype.get=function(n){var r=this;return Xa("DocumentReference.get",arguments,0,1),Mc("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.X_().O_(r.ta).then(function(t){e(new yc(r.firestore,r.ta,t,!0,t instanceof Eo&&t.At,r.wf))},t):r.Rf(e,t,n)})},_c.prototype.Rf=function(e,n,r){var i=this.If({includeMetadataChanges:!0,Il:!0},{next:function(t){i(),!t.exists&&t.metadata.fromCache?n(new Sr(Rr.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&r&&"server"===r.source?n(new Sr(Rr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},_c.prototype.withConverter=function(t){return new _c(this.ta,this.firestore,t)},_c),dc=(Nc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Nc),yc=(Tc.prototype.data=function(t){if(Xa("DocumentSnapshot.data",arguments,0,1),t=Vc("DocumentSnapshot.data",t),this.Af){if(this.wf){var e=new vc(this.ff,this.ta,this.Af,this.Pf,this.Vf);return this.wf.fromFirestore(e,t)}return new ac(this.ff,this.ff._f(),t.serverTimestamps,void 0).U_(this.Af.kt())}},Tc.prototype.get=function(t,e){if(Xa("DocumentSnapshot.get",arguments,1,2),e=Vc("DocumentSnapshot.get",e),this.Af){var n=this.Af.data().field(Xu("DocumentSnapshot.get",t));if(null!==n)return new ac(this.ff,this.ff._f(),e.serverTimestamps,this.wf).U_(n)}},Object.defineProperty(Tc.prototype,"id",{get:function(){return this.ta.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Tc.prototype,"ref",{get:function(){return new pc(this.ta,this.ff,this.wf)},enumerable:!0,configurable:!0}),Object.defineProperty(Tc.prototype,"exists",{get:function(){return null!==this.Af},enumerable:!0,configurable:!0}),Object.defineProperty(Tc.prototype,"metadata",{get:function(){return new dc(this.Vf,this.Pf)},enumerable:!0,configurable:!0}),Tc.prototype.isEqual=function(t){if(!(t instanceof Tc))throw ou("isEqual","DocumentSnapshot",1,t);return this.ff===t.ff&&this.Pf===t.Pf&&this.ta.isEqual(t.ta)&&(null===this.Af?null===t.Af:this.Af.isEqual(t.Af))&&this.wf===t.wf},Tc),vc=(n(Ac,sc=yc),Ac.prototype.data=function(t){return sc.prototype.data.call(this,t)},Ac),gc=(Ic.prototype.where=function(t,e,n){Wa("Query.where",arguments,3),ru("Query.where",3,n);var r,i=function(t,e){if(!t.some(function(t){return t===e}))throw new Sr(Rr.INVALID_ARGUMENT,"Invalid value "+nu(e)+" provided to function Query.where() for its "+au(2)+" argument. Acceptable values: "+t.join(", "));return e}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e),o=Xu("Query.where",t);if(o.Y()){if("array-contains"===i||"array-contains-any"===i)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i){this.yf(n,i);for(var s=[],a=0,u=n;a<u.length;a++){var h=u[a];s.push(this.gf(h))}r={arrayValue:{values:s}}}else r=this.gf(n)}else"in"!==i&&"array-contains-any"!==i||this.yf(n,i),r=this.firestore.nf.Jo("Query.where",n,"in"===i);var c=_o.create(o,i,r);return this.bf(c),new Ic(this.pf.Ht(c),this.firestore,this.wf)},Ic.prototype.orderBy=function(t,e){var n;if(Xa("Query.orderBy",arguments,1,2),Ya("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Sr(Rr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}if(null!==this.pf.startAt)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.pf.endAt)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var r=Xu("Query.orderBy",t),i=new Vo(r,n);return this.vf(i),new Ic(this.pf.Kt(i),this.firestore,this.wf)},Ic.prototype.limit=function(t){return Wa("Query.limit",arguments,1),Ja("Query.limit","number",1,t),su("Query.limit",1,t),new Ic(this.pf.zt(t),this.firestore,this.wf)},Ic.prototype.limitToLast=function(t){return Wa("Query.limitToLast",arguments,1),Ja("Query.limitToLast","number",1,t),su("Query.limitToLast",1,t),new Ic(this.pf.Yt(t),this.firestore,this.wf)},Ic.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Qa("Query.startAt",arguments,1);var r=this.Sf("Query.startAt",t,e,!0);return new Ic(this.pf.Xt(r),this.firestore,this.wf)},Ic.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Qa("Query.startAfter",arguments,1);var r=this.Sf("Query.startAfter",t,e,!1);return new Ic(this.pf.Xt(r),this.firestore,this.wf)},Ic.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Qa("Query.endBefore",arguments,1);var r=this.Sf("Query.endBefore",t,e,!0);return new Ic(this.pf.Jt(r),this.firestore,this.wf)},Ic.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Qa("Query.endAt",arguments,1);var r=this.Sf("Query.endAt",t,e,!1);return new Ic(this.pf.Jt(r),this.firestore,this.wf)},Ic.prototype.isEqual=function(t){if(!(t instanceof Ic))throw ou("isEqual","Query",1,t);return this.firestore===t.firestore&&this.pf.isEqual(t.pf)},Ic.prototype.withConverter=function(t){return new Ic(this.pf,this.firestore,t)},Ic.prototype.Sf=function(t,e,n,r){if(ru(t,1,e),e instanceof yc){if(0<n.length)throw new Sr(Rr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new Sr(Rr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.Cf(i.Af,r)}var o=[e].concat(n);return this.Df(t,o,r)},Ic.prototype.Cf=function(t,e){for(var n=[],r=0,i=this.pf.orderBy;r<i.length;r++){var o=i[r];if(o.field.Y())n.push(gi(this.firestore.Zo,t.key));else{var s=t.field(o.field);if(oi(s))throw new Sr(Rr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var a=o.field.j();throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}n.push(s)}}return new Oo(n,e)},Ic.prototype.Df=function(t,e,n){var r=this.pf.Mt;if(e.length>r.length)throw new Sr(Rr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.Y()){if("string"!=typeof s)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.pf.le()&&-1!==s.indexOf("/"))throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var a=this.pf.path.child(Cr.G(s));if(!Yr.et(a))throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+a+"' is not because it contains an odd number of segments.");var u=new Yr(a);i.push(gi(this.firestore.Zo,u))}else{var h=this.firestore.nf.Jo(t,s);i.push(h)}}return new Oo(i,n)},Ic.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xa("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||ic(t[i])||(iu("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Ka("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=ic(t[i])?t[i]:(Ja("Query.onSnapshot","function",i,t[i]),Ya("Query.onSnapshot","function",i+1,t[i+1]),Ya("Query.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.Ff(this.pf),this.If(r,n)},Ic.prototype.If=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Jh({next:function(t){e.next&&e.next(new mc(n.firestore,n.pf,t,n.wf))},error:r}),o=this.firestore.X_(),s=o.listen(this.pf,i,t);return function(){i.x_(),o.pu(s)}},Ic.prototype.Ff=function(t){if(t.ae()&&0===t.Mt.length)throw new Sr(Rr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Ic.prototype.get=function(n){var r=this;return Xa("Query.get",arguments,0,1),Mc("Query.get",n),this.Ff(this.pf),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.X_().q_(r.pf).then(function(t){e(new mc(r.firestore,r.pf,t,r.wf))},t):r.Rf(e,t,n)})},Ic.prototype.Rf=function(e,n,r){var i=this.If({includeMetadataChanges:!0,Il:!0},{next:function(t){i(),t.metadata.fromCache&&r&&"server"===r.source?n(new Sr(Rr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Ic.prototype.gf=function(t){if("string"==typeof t){if(""===t)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.pf.le()&&-1!==t.indexOf("/"))throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.pf.path.child(Cr.G(t));if(!Yr.et(e))throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return gi(this.firestore.Zo,new Yr(e))}if(t instanceof pc){var n=t;return gi(this.firestore.Zo,n.ta)}throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+nu(t)+".")},Ic.prototype.yf=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Sr(Rr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Ic.prototype.bf=function(t){if(t instanceof _o){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.ue()){var o=this.pf.jt();if(null!==o&&!o.isEqual(t.field))throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.pf.Gt();null!==s&&this.Nf(t.field,s)}else if(i||r){var a=null;if(i&&(a=this.pf.ce(n)),null===a&&r&&(a=this.pf.ce(e)),null!=a)throw a===t.op?new Sr(Rr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Sr(Rr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+a.toString()+"' filters.")}}},Ic.prototype.vf=function(t){if(null===this.pf.Gt()){var e=this.pf.jt();null!==e&&this.Nf(e,t.field)}},Ic.prototype.Nf=function(t,e){if(!e.isEqual(t))throw new Sr(Rr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},Ic),mc=(Object.defineProperty(Ec.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Ec.prototype,"empty",{get:function(){return this.Lf.docs.M()},enumerable:!0,configurable:!0}),Object.defineProperty(Ec.prototype,"size",{get:function(){return this.Lf.docs.size},enumerable:!0,configurable:!0}),Ec.prototype.forEach=function(e,n){var r=this;Xa("QuerySnapshot.forEach",arguments,1,2),Ja("QuerySnapshot.forEach","function",1,e),this.Lf.docs.forEach(function(t){e.call(n,r.qf(t))})},Object.defineProperty(Ec.prototype,"query",{get:function(){return new gc(this.$f,this.ff,this.wf)},enumerable:!0,configurable:!0}),Ec.prototype.docChanges=function(t){t&&(iu("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Ka("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Lf.hs)throw new Sr(Rr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.kf&&this.Of===e||(this.kf=function(i,e,o,s){if(o.ss.M()){var n=0;return o.docChanges.map(function(t){var e=new vc(i,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var a=o.ss;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new vc(i,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s),n=-1,r=-1;return 0!==t.type&&(n=a.indexOf(t.doc.key),a=a.delete(t.doc.key)),1!==t.type&&(r=(a=a.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Zs()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.ff,e,this.Lf,this.wf),this.Of=e),this.kf},Ec.prototype.isEqual=function(t){if(!(t instanceof Ec))throw ou("isEqual","QuerySnapshot",1,t);return this.ff===t.ff&&this.$f.isEqual(t.$f)&&this.Lf.isEqual(t.Lf)&&this.wf===t.wf},Ec.prototype.qf=function(t){return new vc(this.ff,t.key,t,this.metadata.fromCache,this.Lf.ns.has(t.key),this.wf)},Ec),wc=(n(bc,oc=gc),Object.defineProperty(bc.prototype,"id",{get:function(){return this.pf.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(bc.prototype,"parent",{get:function(){var t=this.pf.path.k();return t.M()?null:new pc(new Yr(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(bc.prototype,"path",{get:function(){return this.pf.path.j()},enumerable:!0,configurable:!0}),bc.prototype.doc=function(t){if(Xa("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=ta.cn()),Ja("CollectionReference.doc","non-empty string",1,t),""===t)throw new Sr(Rr.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=Cr.G(t);return pc.lf(this.pf.path.child(e),this.firestore,this.wf)},bc.prototype.add=function(t){Wa("CollectionReference.add",arguments,1),Ja("CollectionReference.add","object",1,this.wf?this.wf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},bc.prototype.withConverter=function(t){return new bc(this.Mf,this.firestore,t)},bc);function bc(t,e,n){var r=this;if(((r=oc.call(this,No.Wt(t),e,n)||this).Mf=t).length%2!=1)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.j()+" has "+t.length);return r}function Ec(t,e,n,r){this.ff=t,this.$f=e,this.Lf=n,this.wf=r,this.kf=null,this.Of=null,this.metadata=new dc(n.hasPendingWrites,n.fromCache)}function Ic(t,e,n){this.pf=t,this.firestore=e,this.wf=n}function Ac(){return null!==sc&&sc.apply(this,arguments)||this}function Tc(t,e,n,r,i,o){this.ff=t,this.ta=e,this.Af=n,this.Pf=r,this.Vf=i,this.wf=o}function Nc(t,e){this.hasPendingWrites=t,this.fromCache=e}function _c(t,e,n){this.ta=t,this.firestore=e,this.wf=n,this.J_=this.firestore.X_()}function Rc(t){this.ff=t,this.Tf=[],this.Ef=!1}function Sc(t,e){this.ff=t,this.df=e}function Dc(t,e,n){var r=this;if(void 0===n&&(n=new Qh),this.z_=null,this.Y_=new Oa,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.X_(),[4,this.J_.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.z_=i,this.Zo=Dc.Z_(i),this.tf=i.name,this.ef=new kr(e)}else{var o=t;if(!o.projectId)throw new Sr(Rr.INVALID_ARGUMENT,"Must provide projectId");this.Zo=new oa(o.projectId,o.database),this.tf="[DEFAULT]",this.ef=new Dr}this.sf=n,this.if=new hc({}),this.nf=new ju(this.Zo)}function kc(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Sr(Rr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Za("settings","non-empty string","host",t.host),this.host=t.host,Ka("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(iu("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),Ka("settings","object","credentials",t.credentials),this.credentials=t.credentials,Ka("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?Js("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Js("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,Ka("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Ca.rh;else{if(t.cacheSizeBytes!==uc&&t.cacheSizeBytes<Ca.nh)throw new Sr(Rr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Ca.nh);this.cacheSizeBytes=t.cacheSizeBytes}Ka("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function Lc(t,e,n,r){this.firestore=t,this.timestampsInSnapshots=e,this.B_=n,this.converter=r}function Oc(t,e){if(void 0===e)return{merge:!1};if(iu(t,e,["merge","mergeFields"]),Ka(t,"boolean","merge",e.merge),n=t,void 0!==(r=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+nu(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Sr(Rr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+nu(n[i]))}(n,"mergeFields",r,function(t){return"string"==typeof t||t instanceof lu}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Sr(Rr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,r;return e}function Vc(t,e){return void 0===e?{}:(iu(t,e,["serverTimestamps"]),$a(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Mc(t,e){Ya(t,"object",1,e),e&&(iu(t,e,["source"]),$a(t,0,"source",e.source,["default","server","cache"]))}function Pc(t,e,n){if(e instanceof pc){if(e.firestore!==n)throw new Sr(Rr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ou(t,"DocumentReference",1,e)}function Cc(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}function Uc(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Sr(Rr.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var qc,xc=Uc(cc,"Use firebase.firestore() instead."),Fc=Uc(fc,"Use firebase.firestore().runTransaction() instead."),jc=Uc(lc,"Use firebase.firestore().batch() instead."),Gc=Uc(pc,"Use firebase.firestore().doc() instead."),Bc=Uc(yc),zc=Uc(vc),Hc=Uc(gc),Wc=Uc(mc),Qc=Uc(wc,"Use firebase.firestore().collection() instead."),Xc=Uc((uf.delete=function(){return Ha("FieldValue.delete",arguments),new Iu},uf.serverTimestamp=function(){return Ha("FieldValue.serverTimestamp",arguments),new Au},uf.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Qa("FieldValue.arrayUnion",arguments,1),new Tu(t)},uf.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Qa("FieldValue.arrayRemove",arguments,1),new Nu(t)},uf.increment=function(t){return Ja("FieldValue.increment","number",1,t),Wa("FieldValue.increment",arguments,1),new _u(t)},uf.prototype.isEqual=function(t){return this===t},uf),"Use FieldValue.<field>() instead."),Jc=Uc(fu,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Yc={Firestore:xc,GeoPoint:Ru,Timestamp:Vr,Blob:Jc,Transaction:Fc,WriteBatch:jc,DocumentReference:Gc,DocumentSnapshot:Bc,Query:Hc,QueryDocumentSnapshot:zc,QuerySnapshot:Wc,CollectionReference:Qc,FieldPath:lu,FieldValue:Xc,setLogLevel:cc.setLogLevel,CACHE_SIZE_UNLIMITED:uc},Zc=(af.prototype.nu=function(t){},af.prototype.Pu=function(){},af),Kc=(sf.prototype.nu=function(t){this.Wf.push(t)},sf.prototype.Pu=function(){window.removeEventListener("online",this.xf),window.removeEventListener("offline",this.Uf)},sf.prototype.jf=function(){window.addEventListener("online",this.xf),window.addEventListener("offline",this.Uf)},sf.prototype.Bf=function(){Xs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Wf;t<e.length;t++)(0,e[t])(0)},sf.prototype.Qf=function(){Xs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Wf;t<e.length;t++)(0,e[t])(1)},sf.Gf=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},sf),$c=(of.prototype.Ra=function(t){this.zf=t},of.prototype.wa=function(t){this.Yf=t},of.prototype.onMessage=function(t){this.Xf=t},of.prototype.close=function(){this.Kf()},of.prototype.send=function(t){this.Hf(t)},of.prototype.Jf=function(){this.zf()},of.prototype.Zf=function(t){this.Yf(t)},of.prototype.td=function(t){this.Xf(t)},of),tf={BatchGetDocuments:"batchGet",Commit:"commit"},ef="gl-js/ fire/"+Er,nf=(rf.prototype.sd=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=ef},rf.prototype.Fa=function(u,r,i){var h=this,c=this.nd(u);return new Promise(function(o,s){var a=new br;a.listenOnce(mr.COMPLETE,function(){try{switch(a.getLastErrorCode()){case gr.NO_ERROR:var t=a.getResponseJson();Xs("Connection","XHR received:",JSON.stringify(t)),o(t);break;case gr.TIMEOUT:Xs("Connection",'RPC "'+u+'" timed out'),s(new Sr(Rr.DEADLINE_EXCEEDED,"Request time out"));break;case gr.HTTP_ERROR:var e=a.getStatus();if(Xs("Connection",'RPC "'+u+'" failed with status:',e,"response text:",a.getResponseText()),0<e){var n=a.getResponseJson().error;if(n&&n.status&&n.message){var r=(i=n.status.toLowerCase().replace("_","-"),0<=Object.values(Rr).indexOf(i)?i:Rr.UNKNOWN);s(new Sr(r,n.message))}else s(new Sr(Rr.UNKNOWN,"Server responded with status "+a.getStatus()))}else Xs("Connection",'RPC "'+u+'" failed'),s(new Sr(Rr.UNAVAILABLE,"Connection failed."));break;default:Zs()}}finally{Xs("Connection",'RPC "'+u+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Xs("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.sd(n,i),a.send(c,"POST",e,n,15)})},rf.prototype.Na=function(t,e,n){return this.Fa(t,e,n)},rf.prototype.Aa=function(t,e){var n,r,i=[this.ed,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=vr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.sd(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(r=p()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=i.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Xs("Connection","Creating WebChannel: "+a+" "+s);var h=o.createWebChannel(a,s),c=!1,f=!1,l=new $c({Hf:function(t){f?Xs("Connection","Not sending because WebChannel is closed:",t):(c||(Xs("Connection","Opening WebChannel transport."),h.open(),c=!0),Xs("Connection","WebChannel sending:",t),h.send(t))},Kf:function(){return h.close()}});return u(wr.EventType.OPEN,function(){f||Xs("Connection","WebChannel transport opened.")}),u(wr.EventType.CLOSE,function(){f||(f=!0,Xs("Connection","WebChannel transport closed"),l.Zf())}),u(wr.EventType.ERROR,function(t){f||(f=!0,Xs("Connection","WebChannel transport errored:",t),l.Zf(new Sr(Rr.UNAVAILABLE,"The operation could not be completed")))}),u(wr.EventType.MESSAGE,function(t){var e;if(!f){var n=t.data[0];Ks(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){Xs("Connection","WebChannel received error:",r);var i=r.status,o=function(){var t=ho[i];if(void 0!==t)return Yo(t)}(),s=r.message;void 0===o&&(o=Rr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.Zf(new Sr(o,s)),h.close()}else Xs("Connection","WebChannel received:",n),l.td(n)}}),setTimeout(function(){l.Jf()},0),l},rf.prototype.nd=function(t){var e=tf[t];return this.ed+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},rf);function rf(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.ed=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function of(t){this.Hf=t.Hf,this.Kf=t.Kf}function sf(){var t=this;this.xf=function(){return t.Bf()},this.Uf=function(){return t.Qf()},this.Wf=[],this.jf()}function af(){}function uf(){}function hf(){this.bo="undefined"!=typeof atob}Bs.an((Object.defineProperty(hf.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(hf.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),hf.prototype.C_=function(t){return Promise.resolve(new nf(t))},hf.prototype.g_=function(){return new(Kc.Gf()?Kc:Zc)},hf.prototype.Go=function(t){return new Fs(t,{hi:!0})},hf.prototype.un=function(t){return JSON.stringify(t)},hf.prototype.atob=function(t){return atob(t)},hf.prototype.btoa=function(t){return btoa(t)},hf.prototype.ln=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n},new hf)),(qc=cf).INTERNAL.registerComponent(new E("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new cc(e,n,new Qh);var e,n},"PUBLIC").setServiceProps(Object.assign({},Yc))),qc.registerVersion("@firebase/firestore","1.14.5")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
